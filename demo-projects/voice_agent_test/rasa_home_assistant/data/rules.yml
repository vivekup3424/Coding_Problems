version: "3.1"

rules:
  # Basic conversation rules
  - rule: Greet user
    steps:
      - intent: greet
      - action: utter_greet

  - rule: Say goodbye anytime the user says goodbye
    steps:
      - intent: goodbye
      - action: utter_goodbye

  - rule: Say thank you anytime the user thanks
    steps:
      - intent: thank
      - action: utter_thank_you

  - rule: Provide help when asked
    steps:
      - intent: ask_help
      - action: utter_help

  # Home automation rules
  - rule: List scenes when asked about scenes
    steps:
      - intent: ask_scenes
      - action: action_list_scenes

  - rule: List rooms when asked about rooms
    steps:
      - intent: ask_rooms
      - action: action_list_rooms

  - rule: List scenes in specific room when asked
    steps:
      - intent: ask_scenes_in_room
      - action: action_list_scenes

  - rule: Remember user room context
    steps:
      - intent: set_room_context
      - action: action_set_room_context

  # Unified scene execution - handles both contextual and explicit scene commands
  - rule: Execute any scene (contextual or explicit)
    steps:
      - intent: good_night
      - action: action_execute_scene

  - rule: Execute any scene (contextual or explicit)
    steps:
      - intent: good_morning
      - action: action_execute_scene

  - rule: Execute any scene (contextual or explicit)
    steps:
      - intent: want_relax
      - action: action_execute_scene

  - rule: Execute any scene (contextual or explicit)
    steps:
      - intent: leaving_home
      - action: action_execute_scene

  - rule: Execute any scene (contextual or explicit)
    steps:
      - intent: coming_home
      - action: action_execute_scene

  - rule: Execute any scene (contextual or explicit)
    steps:
      - intent: going_to_bed
      - action: action_execute_scene

  - rule: Execute any scene (contextual or explicit)
    steps:
      - intent: movie_time
      - action: action_execute_scene

  - rule: Execute any scene (contextual or explicit)
    steps:
      - intent: work_mode
      - action: action_execute_scene

  - rule: Execute any scene (contextual or explicit)
    steps:
      - intent: ac_on
      - action: action_execute_scene

  - rule: Execute any scene (contextual or explicit)
    steps:
      - intent: ac_off
      - action: action_execute_scene

  - rule: Execute any scene (contextual or explicit)
    steps:
      - intent: party_scene
      - action: action_execute_scene

  - rule: Execute any scene (contextual or explicit)
    steps:
      - intent: reading_mode
      - action: action_execute_scene

  # Confirmation handling
  - rule: Handle affirmation
    steps:
      - intent: affirm
      - action: utter_thank_you

  - rule: Handle denial
    steps:
      - intent: deny
      - action: utter_default

  - rule: Execute any scene (contextual or explicit)
    steps:
      - intent: coffee_time
      - action: action_execute_scene

  - rule: Execute any scene (contextual or explicit)
    steps:
      - intent: rain_mood
      - action: action_execute_scene

  - rule: Execute any scene (contextual or explicit)
    steps:
      - intent: romantic_mood
      - action: action_execute_scene

  - rule: Execute any scene (contextual or explicit)
    steps:
      - intent: cool_mode
      - action: action_execute_scene
  
  - rule: Execute custom scene inside a room
    steps:
      - intent: execute_scene
      - action: action_execute_scene

  # Fallback rule for unrecognized inputs
  - rule: Fallback for unclear requests
    steps:
      - intent: nlu_fallback
      - action: utter_default
