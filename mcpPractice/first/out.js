"use strict";var Qr=Object.create;var Mt=Object.defineProperty;var en=Object.getOwnPropertyDescriptor;var tn=Object.getOwnPropertyNames;var rn=Object.getPrototypeOf,nn=Object.prototype.hasOwnProperty;var sn=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of tn(e))!nn.call(r,s)&&s!==t&&Mt(r,s,{get:()=>e[s],enumerable:!(n=en(e,s))||n.enumerable});return r};var Zt=(r,e,t)=>(t=r!=null?Qr(rn(r)):{},sn(e||!r||!r.__esModule?Mt(t,"default",{value:r,enumerable:!0}):t,r));var Yr=Zt(require("moleculer"));var k;(function(r){r.assertEqual=s=>s;function e(s){}r.assertIs=e;function t(s){throw new Error}r.assertNever=t,r.arrayToEnum=s=>{let a={};for(let o of s)a[o]=o;return a},r.getValidEnumValues=s=>{let a=r.objectKeys(s).filter(c=>typeof s[s[c]]!="number"),o={};for(let c of a)o[c]=s[c];return r.objectValues(o)},r.objectValues=s=>r.objectKeys(s).map(function(a){return s[a]}),r.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{let a=[];for(let o in s)Object.prototype.hasOwnProperty.call(s,o)&&a.push(o);return a},r.find=(s,a)=>{for(let o of s)if(a(o))return o},r.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&isFinite(s)&&Math.floor(s)===s;function n(s,a=" | "){return s.map(o=>typeof o=="string"?`'${o}'`:o).join(a)}r.joinValues=n,r.jsonStringifyReplacer=(s,a)=>typeof a=="bigint"?a.toString():a})(k||(k={}));var ht;(function(r){r.mergeShapes=(e,t)=>({...e,...t})})(ht||(ht={}));var h=k.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),J=r=>{switch(typeof r){case"undefined":return h.undefined;case"string":return h.string;case"number":return isNaN(r)?h.nan:h.number;case"boolean":return h.boolean;case"function":return h.function;case"bigint":return h.bigint;case"symbol":return h.symbol;case"object":return Array.isArray(r)?h.array:r===null?h.null:r.then&&typeof r.then=="function"&&r.catch&&typeof r.catch=="function"?h.promise:typeof Map<"u"&&r instanceof Map?h.map:typeof Set<"u"&&r instanceof Set?h.set:typeof Date<"u"&&r instanceof Date?h.date:h.object;default:return h.unknown}},d=k.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),an=r=>JSON.stringify(r,null,2).replace(/"([^"]+)":/g,"$1:"),j=class r extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){let t=e||function(a){return a.message},n={_errors:[]},s=a=>{for(let o of a.issues)if(o.code==="invalid_union")o.unionErrors.map(s);else if(o.code==="invalid_return_type")s(o.returnTypeError);else if(o.code==="invalid_arguments")s(o.argumentsError);else if(o.path.length===0)n._errors.push(t(o));else{let c=n,l=0;for(;l<o.path.length;){let u=o.path[l];l===o.path.length-1?(c[u]=c[u]||{_errors:[]},c[u]._errors.push(t(o))):c[u]=c[u]||{_errors:[]},c=c[u],l++}}};return s(this),n}static assert(e){if(!(e instanceof r))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,k.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){let t={},n=[];for(let s of this.issues)s.path.length>0?(t[s.path[0]]=t[s.path[0]]||[],t[s.path[0]].push(e(s))):n.push(e(s));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}};j.create=r=>new j(r);var ve=(r,e)=>{let t;switch(r.code){case d.invalid_type:r.received===h.undefined?t="Required":t=`Expected ${r.expected}, received ${r.received}`;break;case d.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(r.expected,k.jsonStringifyReplacer)}`;break;case d.unrecognized_keys:t=`Unrecognized key(s) in object: ${k.joinValues(r.keys,", ")}`;break;case d.invalid_union:t="Invalid input";break;case d.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${k.joinValues(r.options)}`;break;case d.invalid_enum_value:t=`Invalid enum value. Expected ${k.joinValues(r.options)}, received '${r.received}'`;break;case d.invalid_arguments:t="Invalid function arguments";break;case d.invalid_return_type:t="Invalid function return type";break;case d.invalid_date:t="Invalid date";break;case d.invalid_string:typeof r.validation=="object"?"includes"in r.validation?(t=`Invalid input: must include "${r.validation.includes}"`,typeof r.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${r.validation.position}`)):"startsWith"in r.validation?t=`Invalid input: must start with "${r.validation.startsWith}"`:"endsWith"in r.validation?t=`Invalid input: must end with "${r.validation.endsWith}"`:k.assertNever(r.validation):r.validation!=="regex"?t=`Invalid ${r.validation}`:t="Invalid";break;case d.too_small:r.type==="array"?t=`Array must contain ${r.exact?"exactly":r.inclusive?"at least":"more than"} ${r.minimum} element(s)`:r.type==="string"?t=`String must contain ${r.exact?"exactly":r.inclusive?"at least":"over"} ${r.minimum} character(s)`:r.type==="number"?t=`Number must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${r.minimum}`:r.type==="date"?t=`Date must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(r.minimum))}`:t="Invalid input";break;case d.too_big:r.type==="array"?t=`Array must contain ${r.exact?"exactly":r.inclusive?"at most":"less than"} ${r.maximum} element(s)`:r.type==="string"?t=`String must contain ${r.exact?"exactly":r.inclusive?"at most":"under"} ${r.maximum} character(s)`:r.type==="number"?t=`Number must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="bigint"?t=`BigInt must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="date"?t=`Date must be ${r.exact?"exactly":r.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(r.maximum))}`:t="Invalid input";break;case d.custom:t="Invalid input";break;case d.invalid_intersection_types:t="Intersection results could not be merged";break;case d.not_multiple_of:t=`Number must be a multiple of ${r.multipleOf}`;break;case d.not_finite:t="Number must be finite";break;default:t=e.defaultError,k.assertNever(r)}return{message:t}},qt=ve;function on(r){qt=r}function Ie(){return qt}var Me=r=>{let{data:e,path:t,errorMaps:n,issueData:s}=r,a=[...t,...s.path||[]],o={...s,path:a};if(s.message!==void 0)return{...s,path:a,message:s.message};let c="",l=n.filter(u=>!!u).slice().reverse();for(let u of l)c=u(o,{data:e,defaultError:c}).message;return{...s,path:a,message:c}},cn=[];function f(r,e){let t=Ie(),n=Me({issueData:e,data:r.data,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,t,t===ve?void 0:ve].filter(s=>!!s)});r.common.issues.push(n)}var R=class r{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){let n=[];for(let s of t){if(s.status==="aborted")return _;s.status==="dirty"&&e.dirty(),n.push(s.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){let n=[];for(let s of t){let a=await s.key,o=await s.value;n.push({key:a,value:o})}return r.mergeObjectSync(e,n)}static mergeObjectSync(e,t){let n={};for(let s of t){let{key:a,value:o}=s;if(a.status==="aborted"||o.status==="aborted")return _;a.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),a.value!=="__proto__"&&(typeof o.value<"u"||s.alwaysSet)&&(n[a.value]=o.value)}return{status:e.value,value:n}}},_=Object.freeze({status:"aborted"}),_e=r=>({status:"dirty",value:r}),C=r=>({status:"valid",value:r}),gt=r=>r.status==="aborted",yt=r=>r.status==="dirty",te=r=>r.status==="valid",Ee=r=>typeof Promise<"u"&&r instanceof Promise;function Ze(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)}function zt(r,e,t,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t}var g;(function(r){r.errToObj=e=>typeof e=="string"?{message:e}:e||{},r.toString=e=>typeof e=="string"?e:e?.message})(g||(g={}));var Ce,Pe,Z=class{constructor(e,t,n,s){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},$t=(r,e)=>{if(te(e))return{success:!0,data:e.value};if(!r.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let t=new j(r.common.issues);return this._error=t,this._error}}};function b(r){if(!r)return{};let{errorMap:e,invalid_type_error:t,required_error:n,description:s}=r;if(e&&(t||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(o,c)=>{var l,u;let{message:m}=r;return o.code==="invalid_enum_value"?{message:m??c.defaultError}:typeof c.data>"u"?{message:(l=m??n)!==null&&l!==void 0?l:c.defaultError}:o.code!=="invalid_type"?{message:c.defaultError}:{message:(u=m??t)!==null&&u!==void 0?u:c.defaultError}},description:s}}var v=class{get description(){return this._def.description}_getType(e){return J(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:J(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new R,ctx:{common:e.parent.common,data:e.data,parsedType:J(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let t=this._parse(e);if(Ee(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){let t=this._parse(e);return Promise.resolve(t)}parse(e,t){let n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){var n;let s={common:{issues:[],async:(n=t?.async)!==null&&n!==void 0?n:!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:J(e)},a=this._parseSync({data:e,path:s.path,parent:s});return $t(s,a)}"~validate"(e){var t,n;let s={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:J(e)};if(!this["~standard"].async)try{let a=this._parseSync({data:e,path:[],parent:s});return te(a)?{value:a.value}:{issues:s.common.issues}}catch(a){!((n=(t=a?.message)===null||t===void 0?void 0:t.toLowerCase())===null||n===void 0)&&n.includes("encountered")&&(this["~standard"].async=!0),s.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:s}).then(a=>te(a)?{value:a.value}:{issues:s.common.issues})}async parseAsync(e,t){let n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){let n={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:J(e)},s=this._parse({data:e,path:n.path,parent:n}),a=await(Ee(s)?s:Promise.resolve(s));return $t(n,a)}refine(e,t){let n=s=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(s):t;return this._refinement((s,a)=>{let o=e(s),c=()=>a.addIssue({code:d.custom,...n(s)});return typeof Promise<"u"&&o instanceof Promise?o.then(l=>l?!0:(c(),!1)):o?!0:(c(),!1)})}refinement(e,t){return this._refinement((n,s)=>e(n)?!0:(s.addIssue(typeof t=="function"?t(n,s):t),!1))}_refinement(e){return new N({schema:this,typeName:p.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return A.create(this,this._def)}nullable(){return F.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return G.create(this)}promise(){return K.create(this,this._def)}or(e){return ce.create([this,e],this._def)}and(e){return le.create(this,e,this._def)}transform(e){return new N({...b(this._def),schema:this,typeName:p.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let t=typeof e=="function"?e:()=>e;return new fe({...b(this._def),innerType:this,defaultValue:t,typeName:p.ZodDefault})}brand(){return new Ae({typeName:p.ZodBranded,type:this,...b(this._def)})}catch(e){let t=typeof e=="function"?e:()=>e;return new he({...b(this._def),innerType:this,catchValue:t,typeName:p.ZodCatch})}describe(e){let t=this.constructor;return new t({...this._def,description:e})}pipe(e){return Oe.create(this,e)}readonly(){return ge.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},ln=/^c[^\s-]{8,}$/i,un=/^[0-9a-z]+$/,dn=/^[0-9A-HJKMNP-TV-Z]{26}$/i,pn=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,mn=/^[a-z0-9_-]{21}$/i,fn=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,hn=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,gn=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,yn="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",ft,_n=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,vn=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,bn=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,xn=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,kn=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,wn=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Ht="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Sn=new RegExp(`^${Ht}$`);function Vt(r){let e="[0-5]\\d";r.precision?e=`${e}\\.\\d{${r.precision}}`:r.precision==null&&(e=`${e}(\\.\\d+)?`);let t=r.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${t}`}function Tn(r){return new RegExp(`^${Vt(r)}$`)}function Ft(r){let e=`${Ht}T${Vt(r)}`,t=[];return t.push(r.local?"Z?":"Z"),r.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function Rn(r,e){return!!((e==="v4"||!e)&&_n.test(r)||(e==="v6"||!e)&&bn.test(r))}function Cn(r,e){if(!fn.test(r))return!1;try{let[t]=r.split("."),n=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),s=JSON.parse(atob(n));return!(typeof s!="object"||s===null||!s.typ||!s.alg||e&&s.alg!==e)}catch{return!1}}function Pn(r,e){return!!((e==="v4"||!e)&&vn.test(r)||(e==="v6"||!e)&&xn.test(r))}var X=class r extends v{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==h.string){let a=this._getOrReturnCtx(e);return f(a,{code:d.invalid_type,expected:h.string,received:a.parsedType}),_}let n=new R,s;for(let a of this._def.checks)if(a.kind==="min")e.data.length<a.value&&(s=this._getOrReturnCtx(e,s),f(s,{code:d.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind==="max")e.data.length>a.value&&(s=this._getOrReturnCtx(e,s),f(s,{code:d.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind==="length"){let o=e.data.length>a.value,c=e.data.length<a.value;(o||c)&&(s=this._getOrReturnCtx(e,s),o?f(s,{code:d.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):c&&f(s,{code:d.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),n.dirty())}else if(a.kind==="email")gn.test(e.data)||(s=this._getOrReturnCtx(e,s),f(s,{validation:"email",code:d.invalid_string,message:a.message}),n.dirty());else if(a.kind==="emoji")ft||(ft=new RegExp(yn,"u")),ft.test(e.data)||(s=this._getOrReturnCtx(e,s),f(s,{validation:"emoji",code:d.invalid_string,message:a.message}),n.dirty());else if(a.kind==="uuid")pn.test(e.data)||(s=this._getOrReturnCtx(e,s),f(s,{validation:"uuid",code:d.invalid_string,message:a.message}),n.dirty());else if(a.kind==="nanoid")mn.test(e.data)||(s=this._getOrReturnCtx(e,s),f(s,{validation:"nanoid",code:d.invalid_string,message:a.message}),n.dirty());else if(a.kind==="cuid")ln.test(e.data)||(s=this._getOrReturnCtx(e,s),f(s,{validation:"cuid",code:d.invalid_string,message:a.message}),n.dirty());else if(a.kind==="cuid2")un.test(e.data)||(s=this._getOrReturnCtx(e,s),f(s,{validation:"cuid2",code:d.invalid_string,message:a.message}),n.dirty());else if(a.kind==="ulid")dn.test(e.data)||(s=this._getOrReturnCtx(e,s),f(s,{validation:"ulid",code:d.invalid_string,message:a.message}),n.dirty());else if(a.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),f(s,{validation:"url",code:d.invalid_string,message:a.message}),n.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),f(s,{validation:"regex",code:d.invalid_string,message:a.message}),n.dirty())):a.kind==="trim"?e.data=e.data.trim():a.kind==="includes"?e.data.includes(a.value,a.position)||(s=this._getOrReturnCtx(e,s),f(s,{code:d.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),n.dirty()):a.kind==="toLowerCase"?e.data=e.data.toLowerCase():a.kind==="toUpperCase"?e.data=e.data.toUpperCase():a.kind==="startsWith"?e.data.startsWith(a.value)||(s=this._getOrReturnCtx(e,s),f(s,{code:d.invalid_string,validation:{startsWith:a.value},message:a.message}),n.dirty()):a.kind==="endsWith"?e.data.endsWith(a.value)||(s=this._getOrReturnCtx(e,s),f(s,{code:d.invalid_string,validation:{endsWith:a.value},message:a.message}),n.dirty()):a.kind==="datetime"?Ft(a).test(e.data)||(s=this._getOrReturnCtx(e,s),f(s,{code:d.invalid_string,validation:"datetime",message:a.message}),n.dirty()):a.kind==="date"?Sn.test(e.data)||(s=this._getOrReturnCtx(e,s),f(s,{code:d.invalid_string,validation:"date",message:a.message}),n.dirty()):a.kind==="time"?Tn(a).test(e.data)||(s=this._getOrReturnCtx(e,s),f(s,{code:d.invalid_string,validation:"time",message:a.message}),n.dirty()):a.kind==="duration"?hn.test(e.data)||(s=this._getOrReturnCtx(e,s),f(s,{validation:"duration",code:d.invalid_string,message:a.message}),n.dirty()):a.kind==="ip"?Rn(e.data,a.version)||(s=this._getOrReturnCtx(e,s),f(s,{validation:"ip",code:d.invalid_string,message:a.message}),n.dirty()):a.kind==="jwt"?Cn(e.data,a.alg)||(s=this._getOrReturnCtx(e,s),f(s,{validation:"jwt",code:d.invalid_string,message:a.message}),n.dirty()):a.kind==="cidr"?Pn(e.data,a.version)||(s=this._getOrReturnCtx(e,s),f(s,{validation:"cidr",code:d.invalid_string,message:a.message}),n.dirty()):a.kind==="base64"?kn.test(e.data)||(s=this._getOrReturnCtx(e,s),f(s,{validation:"base64",code:d.invalid_string,message:a.message}),n.dirty()):a.kind==="base64url"?wn.test(e.data)||(s=this._getOrReturnCtx(e,s),f(s,{validation:"base64url",code:d.invalid_string,message:a.message}),n.dirty()):k.assertNever(a);return{status:n.value,value:e.data}}_regex(e,t,n){return this.refinement(s=>e.test(s),{validation:t,code:d.invalid_string,...g.errToObj(n)})}_addCheck(e){return new r({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...g.errToObj(e)})}url(e){return this._addCheck({kind:"url",...g.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...g.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...g.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...g.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...g.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...g.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...g.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...g.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...g.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...g.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...g.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...g.errToObj(e)})}datetime(e){var t,n;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(t=e?.offset)!==null&&t!==void 0?t:!1,local:(n=e?.local)!==null&&n!==void 0?n:!1,...g.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...g.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...g.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...g.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...g.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...g.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...g.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...g.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...g.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...g.errToObj(t)})}nonempty(e){return this.min(1,g.errToObj(e))}trim(){return new r({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new r({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new r({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}};X.create=r=>{var e;return new X({checks:[],typeName:p.ZodString,coerce:(e=r?.coerce)!==null&&e!==void 0?e:!1,...b(r)})};function En(r,e){let t=(r.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,s=t>n?t:n,a=parseInt(r.toFixed(s).replace(".","")),o=parseInt(e.toFixed(s).replace(".",""));return a%o/Math.pow(10,s)}var re=class r extends v{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==h.number){let a=this._getOrReturnCtx(e);return f(a,{code:d.invalid_type,expected:h.number,received:a.parsedType}),_}let n,s=new R;for(let a of this._def.checks)a.kind==="int"?k.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),f(n,{code:d.invalid_type,expected:"integer",received:"float",message:a.message}),s.dirty()):a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(n=this._getOrReturnCtx(e,n),f(n,{code:d.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),s.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(n=this._getOrReturnCtx(e,n),f(n,{code:d.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),s.dirty()):a.kind==="multipleOf"?En(e.data,a.value)!==0&&(n=this._getOrReturnCtx(e,n),f(n,{code:d.not_multiple_of,multipleOf:a.value,message:a.message}),s.dirty()):a.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),f(n,{code:d.not_finite,message:a.message}),s.dirty()):k.assertNever(a);return{status:s.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,g.toString(t))}gt(e,t){return this.setLimit("min",e,!1,g.toString(t))}lte(e,t){return this.setLimit("max",e,!0,g.toString(t))}lt(e,t){return this.setLimit("max",e,!1,g.toString(t))}setLimit(e,t,n,s){return new r({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:g.toString(s)}]})}_addCheck(e){return new r({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:g.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:g.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:g.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:g.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:g.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:g.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:g.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:g.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:g.toString(e)})}get minValue(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&k.isInteger(e.value))}get isFinite(){let e=null,t=null;for(let n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(t===null||n.value>t)&&(t=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}};re.create=r=>new re({checks:[],typeName:p.ZodNumber,coerce:r?.coerce||!1,...b(r)});var ne=class r extends v{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==h.bigint)return this._getInvalidInput(e);let n,s=new R;for(let a of this._def.checks)a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(n=this._getOrReturnCtx(e,n),f(n,{code:d.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),s.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(n=this._getOrReturnCtx(e,n),f(n,{code:d.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),s.dirty()):a.kind==="multipleOf"?e.data%a.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),f(n,{code:d.not_multiple_of,multipleOf:a.value,message:a.message}),s.dirty()):k.assertNever(a);return{status:s.value,value:e.data}}_getInvalidInput(e){let t=this._getOrReturnCtx(e);return f(t,{code:d.invalid_type,expected:h.bigint,received:t.parsedType}),_}gte(e,t){return this.setLimit("min",e,!0,g.toString(t))}gt(e,t){return this.setLimit("min",e,!1,g.toString(t))}lte(e,t){return this.setLimit("max",e,!0,g.toString(t))}lt(e,t){return this.setLimit("max",e,!1,g.toString(t))}setLimit(e,t,n,s){return new r({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:g.toString(s)}]})}_addCheck(e){return new r({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:g.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:g.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:g.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:g.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:g.toString(t)})}get minValue(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}};ne.create=r=>{var e;return new ne({checks:[],typeName:p.ZodBigInt,coerce:(e=r?.coerce)!==null&&e!==void 0?e:!1,...b(r)})};var se=class extends v{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==h.boolean){let n=this._getOrReturnCtx(e);return f(n,{code:d.invalid_type,expected:h.boolean,received:n.parsedType}),_}return C(e.data)}};se.create=r=>new se({typeName:p.ZodBoolean,coerce:r?.coerce||!1,...b(r)});var ae=class r extends v{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==h.date){let a=this._getOrReturnCtx(e);return f(a,{code:d.invalid_type,expected:h.date,received:a.parsedType}),_}if(isNaN(e.data.getTime())){let a=this._getOrReturnCtx(e);return f(a,{code:d.invalid_date}),_}let n=new R,s;for(let a of this._def.checks)a.kind==="min"?e.data.getTime()<a.value&&(s=this._getOrReturnCtx(e,s),f(s,{code:d.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),n.dirty()):a.kind==="max"?e.data.getTime()>a.value&&(s=this._getOrReturnCtx(e,s),f(s,{code:d.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),n.dirty()):k.assertNever(a);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new r({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:g.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:g.toString(t)})}get minDate(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}};ae.create=r=>new ae({checks:[],coerce:r?.coerce||!1,typeName:p.ZodDate,...b(r)});var be=class extends v{_parse(e){if(this._getType(e)!==h.symbol){let n=this._getOrReturnCtx(e);return f(n,{code:d.invalid_type,expected:h.symbol,received:n.parsedType}),_}return C(e.data)}};be.create=r=>new be({typeName:p.ZodSymbol,...b(r)});var ie=class extends v{_parse(e){if(this._getType(e)!==h.undefined){let n=this._getOrReturnCtx(e);return f(n,{code:d.invalid_type,expected:h.undefined,received:n.parsedType}),_}return C(e.data)}};ie.create=r=>new ie({typeName:p.ZodUndefined,...b(r)});var oe=class extends v{_parse(e){if(this._getType(e)!==h.null){let n=this._getOrReturnCtx(e);return f(n,{code:d.invalid_type,expected:h.null,received:n.parsedType}),_}return C(e.data)}};oe.create=r=>new oe({typeName:p.ZodNull,...b(r)});var Y=class extends v{constructor(){super(...arguments),this._any=!0}_parse(e){return C(e.data)}};Y.create=r=>new Y({typeName:p.ZodAny,...b(r)});var W=class extends v{constructor(){super(...arguments),this._unknown=!0}_parse(e){return C(e.data)}};W.create=r=>new W({typeName:p.ZodUnknown,...b(r)});var $=class extends v{_parse(e){let t=this._getOrReturnCtx(e);return f(t,{code:d.invalid_type,expected:h.never,received:t.parsedType}),_}};$.create=r=>new $({typeName:p.ZodNever,...b(r)});var xe=class extends v{_parse(e){if(this._getType(e)!==h.undefined){let n=this._getOrReturnCtx(e);return f(n,{code:d.invalid_type,expected:h.void,received:n.parsedType}),_}return C(e.data)}};xe.create=r=>new xe({typeName:p.ZodVoid,...b(r)});var G=class r extends v{_parse(e){let{ctx:t,status:n}=this._processInputParams(e),s=this._def;if(t.parsedType!==h.array)return f(t,{code:d.invalid_type,expected:h.array,received:t.parsedType}),_;if(s.exactLength!==null){let o=t.data.length>s.exactLength.value,c=t.data.length<s.exactLength.value;(o||c)&&(f(t,{code:o?d.too_big:d.too_small,minimum:c?s.exactLength.value:void 0,maximum:o?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),n.dirty())}if(s.minLength!==null&&t.data.length<s.minLength.value&&(f(t,{code:d.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),n.dirty()),s.maxLength!==null&&t.data.length>s.maxLength.value&&(f(t,{code:d.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map((o,c)=>s.type._parseAsync(new Z(t,o,t.path,c)))).then(o=>R.mergeArray(n,o));let a=[...t.data].map((o,c)=>s.type._parseSync(new Z(t,o,t.path,c)));return R.mergeArray(n,a)}get element(){return this._def.type}min(e,t){return new r({...this._def,minLength:{value:e,message:g.toString(t)}})}max(e,t){return new r({...this._def,maxLength:{value:e,message:g.toString(t)}})}length(e,t){return new r({...this._def,exactLength:{value:e,message:g.toString(t)}})}nonempty(e){return this.min(1,e)}};G.create=(r,e)=>new G({type:r,minLength:null,maxLength:null,exactLength:null,typeName:p.ZodArray,...b(e)});function ye(r){if(r instanceof O){let e={};for(let t in r.shape){let n=r.shape[t];e[t]=A.create(ye(n))}return new O({...r._def,shape:()=>e})}else return r instanceof G?new G({...r._def,type:ye(r.element)}):r instanceof A?A.create(ye(r.unwrap())):r instanceof F?F.create(ye(r.unwrap())):r instanceof V?V.create(r.items.map(e=>ye(e))):r}var O=class r extends v{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),t=k.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==h.object){let u=this._getOrReturnCtx(e);return f(u,{code:d.invalid_type,expected:h.object,received:u.parsedType}),_}let{status:n,ctx:s}=this._processInputParams(e),{shape:a,keys:o}=this._getCached(),c=[];if(!(this._def.catchall instanceof $&&this._def.unknownKeys==="strip"))for(let u in s.data)o.includes(u)||c.push(u);let l=[];for(let u of o){let m=a[u],w=s.data[u];l.push({key:{status:"valid",value:u},value:m._parse(new Z(s,w,s.path,u)),alwaysSet:u in s.data})}if(this._def.catchall instanceof $){let u=this._def.unknownKeys;if(u==="passthrough")for(let m of c)l.push({key:{status:"valid",value:m},value:{status:"valid",value:s.data[m]}});else if(u==="strict")c.length>0&&(f(s,{code:d.unrecognized_keys,keys:c}),n.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let u=this._def.catchall;for(let m of c){let w=s.data[m];l.push({key:{status:"valid",value:m},value:u._parse(new Z(s,w,s.path,m)),alwaysSet:m in s.data})}}return s.common.async?Promise.resolve().then(async()=>{let u=[];for(let m of l){let w=await m.key,E=await m.value;u.push({key:w,value:E,alwaysSet:m.alwaysSet})}return u}).then(u=>R.mergeObjectSync(n,u)):R.mergeObjectSync(n,l)}get shape(){return this._def.shape()}strict(e){return g.errToObj,new r({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,n)=>{var s,a,o,c;let l=(o=(a=(s=this._def).errorMap)===null||a===void 0?void 0:a.call(s,t,n).message)!==null&&o!==void 0?o:n.defaultError;return t.code==="unrecognized_keys"?{message:(c=g.errToObj(e).message)!==null&&c!==void 0?c:l}:{message:l}}}:{}})}strip(){return new r({...this._def,unknownKeys:"strip"})}passthrough(){return new r({...this._def,unknownKeys:"passthrough"})}extend(e){return new r({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new r({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:p.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new r({...this._def,catchall:e})}pick(e){let t={};return k.objectKeys(e).forEach(n=>{e[n]&&this.shape[n]&&(t[n]=this.shape[n])}),new r({...this._def,shape:()=>t})}omit(e){let t={};return k.objectKeys(this.shape).forEach(n=>{e[n]||(t[n]=this.shape[n])}),new r({...this._def,shape:()=>t})}deepPartial(){return ye(this)}partial(e){let t={};return k.objectKeys(this.shape).forEach(n=>{let s=this.shape[n];e&&!e[n]?t[n]=s:t[n]=s.optional()}),new r({...this._def,shape:()=>t})}required(e){let t={};return k.objectKeys(this.shape).forEach(n=>{if(e&&!e[n])t[n]=this.shape[n];else{let a=this.shape[n];for(;a instanceof A;)a=a._def.innerType;t[n]=a}}),new r({...this._def,shape:()=>t})}keyof(){return Ut(k.objectKeys(this.shape))}};O.create=(r,e)=>new O({shape:()=>r,unknownKeys:"strip",catchall:$.create(),typeName:p.ZodObject,...b(e)});O.strictCreate=(r,e)=>new O({shape:()=>r,unknownKeys:"strict",catchall:$.create(),typeName:p.ZodObject,...b(e)});O.lazycreate=(r,e)=>new O({shape:r,unknownKeys:"strip",catchall:$.create(),typeName:p.ZodObject,...b(e)});var ce=class extends v{_parse(e){let{ctx:t}=this._processInputParams(e),n=this._def.options;function s(a){for(let c of a)if(c.result.status==="valid")return c.result;for(let c of a)if(c.result.status==="dirty")return t.common.issues.push(...c.ctx.common.issues),c.result;let o=a.map(c=>new j(c.ctx.common.issues));return f(t,{code:d.invalid_union,unionErrors:o}),_}if(t.common.async)return Promise.all(n.map(async a=>{let o={...t,common:{...t.common,issues:[]},parent:null};return{result:await a._parseAsync({data:t.data,path:t.path,parent:o}),ctx:o}})).then(s);{let a,o=[];for(let l of n){let u={...t,common:{...t.common,issues:[]},parent:null},m=l._parseSync({data:t.data,path:t.path,parent:u});if(m.status==="valid")return m;m.status==="dirty"&&!a&&(a={result:m,ctx:u}),u.common.issues.length&&o.push(u.common.issues)}if(a)return t.common.issues.push(...a.ctx.common.issues),a.result;let c=o.map(l=>new j(l));return f(t,{code:d.invalid_union,unionErrors:c}),_}}get options(){return this._def.options}};ce.create=(r,e)=>new ce({options:r,typeName:p.ZodUnion,...b(e)});var B=r=>r instanceof ue?B(r.schema):r instanceof N?B(r.innerType()):r instanceof de?[r.value]:r instanceof pe?r.options:r instanceof me?k.objectValues(r.enum):r instanceof fe?B(r._def.innerType):r instanceof ie?[void 0]:r instanceof oe?[null]:r instanceof A?[void 0,...B(r.unwrap())]:r instanceof F?[null,...B(r.unwrap())]:r instanceof Ae||r instanceof ge?B(r.unwrap()):r instanceof he?B(r._def.innerType):[],$e=class r extends v{_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==h.object)return f(t,{code:d.invalid_type,expected:h.object,received:t.parsedType}),_;let n=this.discriminator,s=t.data[n],a=this.optionsMap.get(s);return a?t.common.async?a._parseAsync({data:t.data,path:t.path,parent:t}):a._parseSync({data:t.data,path:t.path,parent:t}):(f(t,{code:d.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),_)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,n){let s=new Map;for(let a of t){let o=B(a.shape[e]);if(!o.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let c of o){if(s.has(c))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(c)}`);s.set(c,a)}}return new r({typeName:p.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:s,...b(n)})}};function _t(r,e){let t=J(r),n=J(e);if(r===e)return{valid:!0,data:r};if(t===h.object&&n===h.object){let s=k.objectKeys(e),a=k.objectKeys(r).filter(c=>s.indexOf(c)!==-1),o={...r,...e};for(let c of a){let l=_t(r[c],e[c]);if(!l.valid)return{valid:!1};o[c]=l.data}return{valid:!0,data:o}}else if(t===h.array&&n===h.array){if(r.length!==e.length)return{valid:!1};let s=[];for(let a=0;a<r.length;a++){let o=r[a],c=e[a],l=_t(o,c);if(!l.valid)return{valid:!1};s.push(l.data)}return{valid:!0,data:s}}else return t===h.date&&n===h.date&&+r==+e?{valid:!0,data:r}:{valid:!1}}var le=class extends v{_parse(e){let{status:t,ctx:n}=this._processInputParams(e),s=(a,o)=>{if(gt(a)||gt(o))return _;let c=_t(a.value,o.value);return c.valid?((yt(a)||yt(o))&&t.dirty(),{status:t.value,value:c.data}):(f(n,{code:d.invalid_intersection_types}),_)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([a,o])=>s(a,o)):s(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}};le.create=(r,e,t)=>new le({left:r,right:e,typeName:p.ZodIntersection,...b(t)});var V=class r extends v{_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==h.array)return f(n,{code:d.invalid_type,expected:h.array,received:n.parsedType}),_;if(n.data.length<this._def.items.length)return f(n,{code:d.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),_;!this._def.rest&&n.data.length>this._def.items.length&&(f(n,{code:d.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());let a=[...n.data].map((o,c)=>{let l=this._def.items[c]||this._def.rest;return l?l._parse(new Z(n,o,n.path,c)):null}).filter(o=>!!o);return n.common.async?Promise.all(a).then(o=>R.mergeArray(t,o)):R.mergeArray(t,a)}get items(){return this._def.items}rest(e){return new r({...this._def,rest:e})}};V.create=(r,e)=>{if(!Array.isArray(r))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new V({items:r,typeName:p.ZodTuple,rest:null,...b(e)})};var Le=class r extends v{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==h.object)return f(n,{code:d.invalid_type,expected:h.object,received:n.parsedType}),_;let s=[],a=this._def.keyType,o=this._def.valueType;for(let c in n.data)s.push({key:a._parse(new Z(n,c,n.path,c)),value:o._parse(new Z(n,n.data[c],n.path,c)),alwaysSet:c in n.data});return n.common.async?R.mergeObjectAsync(t,s):R.mergeObjectSync(t,s)}get element(){return this._def.valueType}static create(e,t,n){return t instanceof v?new r({keyType:e,valueType:t,typeName:p.ZodRecord,...b(n)}):new r({keyType:X.create(),valueType:e,typeName:p.ZodRecord,...b(t)})}},ke=class extends v{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==h.map)return f(n,{code:d.invalid_type,expected:h.map,received:n.parsedType}),_;let s=this._def.keyType,a=this._def.valueType,o=[...n.data.entries()].map(([c,l],u)=>({key:s._parse(new Z(n,c,n.path,[u,"key"])),value:a._parse(new Z(n,l,n.path,[u,"value"]))}));if(n.common.async){let c=new Map;return Promise.resolve().then(async()=>{for(let l of o){let u=await l.key,m=await l.value;if(u.status==="aborted"||m.status==="aborted")return _;(u.status==="dirty"||m.status==="dirty")&&t.dirty(),c.set(u.value,m.value)}return{status:t.value,value:c}})}else{let c=new Map;for(let l of o){let u=l.key,m=l.value;if(u.status==="aborted"||m.status==="aborted")return _;(u.status==="dirty"||m.status==="dirty")&&t.dirty(),c.set(u.value,m.value)}return{status:t.value,value:c}}}};ke.create=(r,e,t)=>new ke({valueType:e,keyType:r,typeName:p.ZodMap,...b(t)});var we=class r extends v{_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==h.set)return f(n,{code:d.invalid_type,expected:h.set,received:n.parsedType}),_;let s=this._def;s.minSize!==null&&n.data.size<s.minSize.value&&(f(n,{code:d.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),t.dirty()),s.maxSize!==null&&n.data.size>s.maxSize.value&&(f(n,{code:d.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),t.dirty());let a=this._def.valueType;function o(l){let u=new Set;for(let m of l){if(m.status==="aborted")return _;m.status==="dirty"&&t.dirty(),u.add(m.value)}return{status:t.value,value:u}}let c=[...n.data.values()].map((l,u)=>a._parse(new Z(n,l,n.path,u)));return n.common.async?Promise.all(c).then(l=>o(l)):o(c)}min(e,t){return new r({...this._def,minSize:{value:e,message:g.toString(t)}})}max(e,t){return new r({...this._def,maxSize:{value:e,message:g.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}};we.create=(r,e)=>new we({valueType:r,minSize:null,maxSize:null,typeName:p.ZodSet,...b(e)});var De=class r extends v{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==h.function)return f(t,{code:d.invalid_type,expected:h.function,received:t.parsedType}),_;function n(c,l){return Me({data:c,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Ie(),ve].filter(u=>!!u),issueData:{code:d.invalid_arguments,argumentsError:l}})}function s(c,l){return Me({data:c,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Ie(),ve].filter(u=>!!u),issueData:{code:d.invalid_return_type,returnTypeError:l}})}let a={errorMap:t.common.contextualErrorMap},o=t.data;if(this._def.returns instanceof K){let c=this;return C(async function(...l){let u=new j([]),m=await c._def.args.parseAsync(l,a).catch(Q=>{throw u.addIssue(n(l,Q)),u}),w=await Reflect.apply(o,this,m);return await c._def.returns._def.type.parseAsync(w,a).catch(Q=>{throw u.addIssue(s(w,Q)),u})})}else{let c=this;return C(function(...l){let u=c._def.args.safeParse(l,a);if(!u.success)throw new j([n(l,u.error)]);let m=Reflect.apply(o,this,u.data),w=c._def.returns.safeParse(m,a);if(!w.success)throw new j([s(m,w.error)]);return w.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new r({...this._def,args:V.create(e).rest(W.create())})}returns(e){return new r({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,n){return new r({args:e||V.create([]).rest(W.create()),returns:t||W.create(),typeName:p.ZodFunction,...b(n)})}},ue=class extends v{get schema(){return this._def.getter()}_parse(e){let{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}};ue.create=(r,e)=>new ue({getter:r,typeName:p.ZodLazy,...b(e)});var de=class extends v{_parse(e){if(e.data!==this._def.value){let t=this._getOrReturnCtx(e);return f(t,{received:t.data,code:d.invalid_literal,expected:this._def.value}),_}return{status:"valid",value:e.data}}get value(){return this._def.value}};de.create=(r,e)=>new de({value:r,typeName:p.ZodLiteral,...b(e)});function Ut(r,e){return new pe({values:r,typeName:p.ZodEnum,...b(e)})}var pe=class r extends v{constructor(){super(...arguments),Ce.set(this,void 0)}_parse(e){if(typeof e.data!="string"){let t=this._getOrReturnCtx(e),n=this._def.values;return f(t,{expected:k.joinValues(n),received:t.parsedType,code:d.invalid_type}),_}if(Ze(this,Ce,"f")||zt(this,Ce,new Set(this._def.values),"f"),!Ze(this,Ce,"f").has(e.data)){let t=this._getOrReturnCtx(e),n=this._def.values;return f(t,{received:t.data,code:d.invalid_enum_value,options:n}),_}return C(e.data)}get options(){return this._def.values}get enum(){let e={};for(let t of this._def.values)e[t]=t;return e}get Values(){let e={};for(let t of this._def.values)e[t]=t;return e}get Enum(){let e={};for(let t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return r.create(e,{...this._def,...t})}exclude(e,t=this._def){return r.create(this.options.filter(n=>!e.includes(n)),{...this._def,...t})}};Ce=new WeakMap;pe.create=Ut;var me=class extends v{constructor(){super(...arguments),Pe.set(this,void 0)}_parse(e){let t=k.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==h.string&&n.parsedType!==h.number){let s=k.objectValues(t);return f(n,{expected:k.joinValues(s),received:n.parsedType,code:d.invalid_type}),_}if(Ze(this,Pe,"f")||zt(this,Pe,new Set(k.getValidEnumValues(this._def.values)),"f"),!Ze(this,Pe,"f").has(e.data)){let s=k.objectValues(t);return f(n,{received:n.data,code:d.invalid_enum_value,options:s}),_}return C(e.data)}get enum(){return this._def.values}};Pe=new WeakMap;me.create=(r,e)=>new me({values:r,typeName:p.ZodNativeEnum,...b(e)});var K=class extends v{unwrap(){return this._def.type}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==h.promise&&t.common.async===!1)return f(t,{code:d.invalid_type,expected:h.promise,received:t.parsedType}),_;let n=t.parsedType===h.promise?t.data:Promise.resolve(t.data);return C(n.then(s=>this._def.type.parseAsync(s,{path:t.path,errorMap:t.common.contextualErrorMap})))}};K.create=(r,e)=>new K({type:r,typeName:p.ZodPromise,...b(e)});var N=class extends v{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===p.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:t,ctx:n}=this._processInputParams(e),s=this._def.effect||null,a={addIssue:o=>{f(n,o),o.fatal?t.abort():t.dirty()},get path(){return n.path}};if(a.addIssue=a.addIssue.bind(a),s.type==="preprocess"){let o=s.transform(n.data,a);if(n.common.async)return Promise.resolve(o).then(async c=>{if(t.value==="aborted")return _;let l=await this._def.schema._parseAsync({data:c,path:n.path,parent:n});return l.status==="aborted"?_:l.status==="dirty"||t.value==="dirty"?_e(l.value):l});{if(t.value==="aborted")return _;let c=this._def.schema._parseSync({data:o,path:n.path,parent:n});return c.status==="aborted"?_:c.status==="dirty"||t.value==="dirty"?_e(c.value):c}}if(s.type==="refinement"){let o=c=>{let l=s.refinement(c,a);if(n.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return c};if(n.common.async===!1){let c=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return c.status==="aborted"?_:(c.status==="dirty"&&t.dirty(),o(c.value),{status:t.value,value:c.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(c=>c.status==="aborted"?_:(c.status==="dirty"&&t.dirty(),o(c.value).then(()=>({status:t.value,value:c.value}))))}if(s.type==="transform")if(n.common.async===!1){let o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!te(o))return o;let c=s.transform(o.value,a);if(c instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:c}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(o=>te(o)?Promise.resolve(s.transform(o.value,a)).then(c=>({status:t.value,value:c})):o);k.assertNever(s)}};N.create=(r,e,t)=>new N({schema:r,typeName:p.ZodEffects,effect:e,...b(t)});N.createWithPreprocess=(r,e,t)=>new N({schema:e,effect:{type:"preprocess",transform:r},typeName:p.ZodEffects,...b(t)});var A=class extends v{_parse(e){return this._getType(e)===h.undefined?C(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};A.create=(r,e)=>new A({innerType:r,typeName:p.ZodOptional,...b(e)});var F=class extends v{_parse(e){return this._getType(e)===h.null?C(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};F.create=(r,e)=>new F({innerType:r,typeName:p.ZodNullable,...b(e)});var fe=class extends v{_parse(e){let{ctx:t}=this._processInputParams(e),n=t.data;return t.parsedType===h.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}};fe.create=(r,e)=>new fe({innerType:r,typeName:p.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...b(e)});var he=class extends v{_parse(e){let{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},s=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return Ee(s)?s.then(a=>({status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new j(n.common.issues)},input:n.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new j(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}};he.create=(r,e)=>new he({innerType:r,typeName:p.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...b(e)});var Se=class extends v{_parse(e){if(this._getType(e)!==h.nan){let n=this._getOrReturnCtx(e);return f(n,{code:d.invalid_type,expected:h.nan,received:n.parsedType}),_}return{status:"valid",value:e.data}}};Se.create=r=>new Se({typeName:p.ZodNaN,...b(r)});var An=Symbol("zod_brand"),Ae=class extends v{_parse(e){let{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}},Oe=class r extends v{_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{let a=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?_:a.status==="dirty"?(t.dirty(),_e(a.value)):this._def.out._parseAsync({data:a.value,path:n.path,parent:n})})();{let s=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?_:s.status==="dirty"?(t.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:n.path,parent:n})}}static create(e,t){return new r({in:e,out:t,typeName:p.ZodPipeline})}},ge=class extends v{_parse(e){let t=this._def.innerType._parse(e),n=s=>(te(s)&&(s.value=Object.freeze(s.value)),s);return Ee(t)?t.then(s=>n(s)):n(t)}unwrap(){return this._def.innerType}};ge.create=(r,e)=>new ge({innerType:r,typeName:p.ZodReadonly,...b(e)});function Lt(r,e){let t=typeof r=="function"?r(e):typeof r=="string"?{message:r}:r;return typeof t=="string"?{message:t}:t}function Bt(r,e={},t){return r?Y.create().superRefine((n,s)=>{var a,o;let c=r(n);if(c instanceof Promise)return c.then(l=>{var u,m;if(!l){let w=Lt(e,n),E=(m=(u=w.fatal)!==null&&u!==void 0?u:t)!==null&&m!==void 0?m:!0;s.addIssue({code:"custom",...w,fatal:E})}});if(!c){let l=Lt(e,n),u=(o=(a=l.fatal)!==null&&a!==void 0?a:t)!==null&&o!==void 0?o:!0;s.addIssue({code:"custom",...l,fatal:u})}}):Y.create()}var On={object:O.lazycreate},p;(function(r){r.ZodString="ZodString",r.ZodNumber="ZodNumber",r.ZodNaN="ZodNaN",r.ZodBigInt="ZodBigInt",r.ZodBoolean="ZodBoolean",r.ZodDate="ZodDate",r.ZodSymbol="ZodSymbol",r.ZodUndefined="ZodUndefined",r.ZodNull="ZodNull",r.ZodAny="ZodAny",r.ZodUnknown="ZodUnknown",r.ZodNever="ZodNever",r.ZodVoid="ZodVoid",r.ZodArray="ZodArray",r.ZodObject="ZodObject",r.ZodUnion="ZodUnion",r.ZodDiscriminatedUnion="ZodDiscriminatedUnion",r.ZodIntersection="ZodIntersection",r.ZodTuple="ZodTuple",r.ZodRecord="ZodRecord",r.ZodMap="ZodMap",r.ZodSet="ZodSet",r.ZodFunction="ZodFunction",r.ZodLazy="ZodLazy",r.ZodLiteral="ZodLiteral",r.ZodEnum="ZodEnum",r.ZodEffects="ZodEffects",r.ZodNativeEnum="ZodNativeEnum",r.ZodOptional="ZodOptional",r.ZodNullable="ZodNullable",r.ZodDefault="ZodDefault",r.ZodCatch="ZodCatch",r.ZodPromise="ZodPromise",r.ZodBranded="ZodBranded",r.ZodPipeline="ZodPipeline",r.ZodReadonly="ZodReadonly"})(p||(p={}));var jn=(r,e={message:`Input not instance of ${r.name}`})=>Bt(t=>t instanceof r,e),Jt=X.create,Wt=re.create,Nn=Se.create,In=ne.create,Gt=se.create,Mn=ae.create,Zn=be.create,$n=ie.create,Ln=oe.create,Dn=Y.create,qn=W.create,zn=$.create,Hn=xe.create,Vn=G.create,Fn=O.create,Un=O.strictCreate,Bn=ce.create,Jn=$e.create,Wn=le.create,Gn=V.create,Xn=Le.create,Yn=ke.create,Kn=we.create,Qn=De.create,es=ue.create,ts=de.create,rs=pe.create,ns=me.create,ss=K.create,Dt=N.create,as=A.create,is=F.create,os=N.createWithPreprocess,cs=Oe.create,ls=()=>Jt().optional(),us=()=>Wt().optional(),ds=()=>Gt().optional(),ps={string:r=>X.create({...r,coerce:!0}),number:r=>re.create({...r,coerce:!0}),boolean:r=>se.create({...r,coerce:!0}),bigint:r=>ne.create({...r,coerce:!0}),date:r=>ae.create({...r,coerce:!0})},ms=_,i=Object.freeze({__proto__:null,defaultErrorMap:ve,setErrorMap:on,getErrorMap:Ie,makeIssue:Me,EMPTY_PATH:cn,addIssueToContext:f,ParseStatus:R,INVALID:_,DIRTY:_e,OK:C,isAborted:gt,isDirty:yt,isValid:te,isAsync:Ee,get util(){return k},get objectUtil(){return ht},ZodParsedType:h,getParsedType:J,ZodType:v,datetimeRegex:Ft,ZodString:X,ZodNumber:re,ZodBigInt:ne,ZodBoolean:se,ZodDate:ae,ZodSymbol:be,ZodUndefined:ie,ZodNull:oe,ZodAny:Y,ZodUnknown:W,ZodNever:$,ZodVoid:xe,ZodArray:G,ZodObject:O,ZodUnion:ce,ZodDiscriminatedUnion:$e,ZodIntersection:le,ZodTuple:V,ZodRecord:Le,ZodMap:ke,ZodSet:we,ZodFunction:De,ZodLazy:ue,ZodLiteral:de,ZodEnum:pe,ZodNativeEnum:me,ZodPromise:K,ZodEffects:N,ZodTransformer:N,ZodOptional:A,ZodNullable:F,ZodDefault:fe,ZodCatch:he,ZodNaN:Se,BRAND:An,ZodBranded:Ae,ZodPipeline:Oe,ZodReadonly:ge,custom:Bt,Schema:v,ZodSchema:v,late:On,get ZodFirstPartyTypeKind(){return p},coerce:ps,any:Dn,array:Vn,bigint:In,boolean:Gt,date:Mn,discriminatedUnion:Jn,effect:Dt,enum:rs,function:Qn,instanceof:jn,intersection:Wn,lazy:es,literal:ts,map:Yn,nan:Nn,nativeEnum:ns,never:zn,null:Ln,nullable:is,number:Wt,object:Fn,oboolean:ds,onumber:us,optional:as,ostring:ls,pipeline:cs,preprocess:os,promise:ss,record:Xn,set:Kn,strictObject:Un,string:Jt,symbol:Zn,transformer:Dt,tuple:Gn,undefined:$n,union:Bn,unknown:qn,void:Hn,NEVER:ms,ZodIssueCode:d,quotelessJson:an,ZodError:j});var vt="2025-03-26",Xt=[vt,"2024-11-05","2024-10-07"],qe="2.0",Yt=i.union([i.string(),i.number().int()]),Kt=i.string(),fs=i.object({progressToken:i.optional(Yt)}).passthrough(),L=i.object({_meta:i.optional(fs)}).passthrough(),I=i.object({method:i.string(),params:i.optional(L)}),je=i.object({_meta:i.optional(i.object({}).passthrough())}).passthrough(),U=i.object({method:i.string(),params:i.optional(je)}),D=i.object({_meta:i.optional(i.object({}).passthrough())}).passthrough(),ze=i.union([i.string(),i.number().int()]),Qt=i.object({jsonrpc:i.literal(qe),id:ze}).merge(I).strict(),er=r=>Qt.safeParse(r).success,tr=i.object({jsonrpc:i.literal(qe)}).merge(U).strict(),rr=r=>tr.safeParse(r).success,nr=i.object({jsonrpc:i.literal(qe),id:ze,result:D}).strict(),bt=r=>nr.safeParse(r).success,S;(function(r){r[r.ConnectionClosed=-32e3]="ConnectionClosed",r[r.RequestTimeout=-32001]="RequestTimeout",r[r.ParseError=-32700]="ParseError",r[r.InvalidRequest=-32600]="InvalidRequest",r[r.MethodNotFound=-32601]="MethodNotFound",r[r.InvalidParams=-32602]="InvalidParams",r[r.InternalError=-32603]="InternalError"})(S||(S={}));var sr=i.object({jsonrpc:i.literal(qe),id:ze,error:i.object({code:i.number().int(),message:i.string(),data:i.optional(i.unknown())})}).strict(),ar=r=>sr.safeParse(r).success,ir=i.union([Qt,tr,nr,sr]),He=D.strict(),Ve=U.extend({method:i.literal("notifications/cancelled"),params:je.extend({requestId:ze,reason:i.string().optional()})}),or=i.object({name:i.string(),version:i.string()}).passthrough(),hs=i.object({experimental:i.optional(i.object({}).passthrough()),sampling:i.optional(i.object({}).passthrough()),roots:i.optional(i.object({listChanged:i.optional(i.boolean())}).passthrough())}).passthrough(),xt=I.extend({method:i.literal("initialize"),params:L.extend({protocolVersion:i.string(),capabilities:hs,clientInfo:or})});var gs=i.object({experimental:i.optional(i.object({}).passthrough()),logging:i.optional(i.object({}).passthrough()),completions:i.optional(i.object({}).passthrough()),prompts:i.optional(i.object({listChanged:i.optional(i.boolean())}).passthrough()),resources:i.optional(i.object({subscribe:i.optional(i.boolean()),listChanged:i.optional(i.boolean())}).passthrough()),tools:i.optional(i.object({listChanged:i.optional(i.boolean())}).passthrough())}).passthrough(),ys=D.extend({protocolVersion:i.string(),capabilities:gs,serverInfo:or,instructions:i.optional(i.string())}),kt=U.extend({method:i.literal("notifications/initialized")});var Fe=I.extend({method:i.literal("ping")}),_s=i.object({progress:i.number(),total:i.optional(i.number())}).passthrough(),Ue=U.extend({method:i.literal("notifications/progress"),params:je.merge(_s).extend({progressToken:Yt})}),Be=I.extend({params:L.extend({cursor:i.optional(Kt)}).optional()}),Je=D.extend({nextCursor:i.optional(Kt)}),cr=i.object({uri:i.string(),mimeType:i.optional(i.string())}).passthrough(),lr=cr.extend({text:i.string()}),ur=cr.extend({blob:i.string().base64()}),vs=i.object({uri:i.string(),name:i.string(),description:i.optional(i.string()),mimeType:i.optional(i.string())}).passthrough(),bs=i.object({uriTemplate:i.string(),name:i.string(),description:i.optional(i.string()),mimeType:i.optional(i.string())}).passthrough(),We=Be.extend({method:i.literal("resources/list")}),xs=Je.extend({resources:i.array(vs)}),Ge=Be.extend({method:i.literal("resources/templates/list")}),ks=Je.extend({resourceTemplates:i.array(bs)}),Xe=I.extend({method:i.literal("resources/read"),params:L.extend({uri:i.string()})}),ws=D.extend({contents:i.array(i.union([lr,ur]))}),Ss=U.extend({method:i.literal("notifications/resources/list_changed")}),Ts=I.extend({method:i.literal("resources/subscribe"),params:L.extend({uri:i.string()})}),Rs=I.extend({method:i.literal("resources/unsubscribe"),params:L.extend({uri:i.string()})}),Cs=U.extend({method:i.literal("notifications/resources/updated"),params:je.extend({uri:i.string()})}),Ps=i.object({name:i.string(),description:i.optional(i.string()),required:i.optional(i.boolean())}).passthrough(),Es=i.object({name:i.string(),description:i.optional(i.string()),arguments:i.optional(i.array(Ps))}).passthrough(),Ye=Be.extend({method:i.literal("prompts/list")}),As=Je.extend({prompts:i.array(Es)}),Ke=I.extend({method:i.literal("prompts/get"),params:L.extend({name:i.string(),arguments:i.optional(i.record(i.string()))})}),Qe=i.object({type:i.literal("text"),text:i.string()}).passthrough(),et=i.object({type:i.literal("image"),data:i.string().base64(),mimeType:i.string()}).passthrough(),tt=i.object({type:i.literal("audio"),data:i.string().base64(),mimeType:i.string()}).passthrough(),dr=i.object({type:i.literal("resource"),resource:i.union([lr,ur])}).passthrough(),Os=i.object({role:i.enum(["user","assistant"]),content:i.union([Qe,et,tt,dr])}).passthrough(),js=D.extend({description:i.optional(i.string()),messages:i.array(Os)}),Ns=U.extend({method:i.literal("notifications/prompts/list_changed")}),Is=i.object({title:i.optional(i.string()),readOnlyHint:i.optional(i.boolean()),destructiveHint:i.optional(i.boolean()),idempotentHint:i.optional(i.boolean()),openWorldHint:i.optional(i.boolean())}).passthrough(),Ms=i.object({name:i.string(),description:i.optional(i.string()),inputSchema:i.object({type:i.literal("object"),properties:i.optional(i.object({}).passthrough())}).passthrough(),annotations:i.optional(Is)}).passthrough(),rt=Be.extend({method:i.literal("tools/list")}),Zs=Je.extend({tools:i.array(Ms)}),pr=D.extend({content:i.array(i.union([Qe,et,tt,dr])),isError:i.boolean().default(!1).optional()}),fa=pr.or(D.extend({toolResult:i.unknown()})),nt=I.extend({method:i.literal("tools/call"),params:L.extend({name:i.string(),arguments:i.optional(i.record(i.unknown()))})}),$s=U.extend({method:i.literal("notifications/tools/list_changed")}),mr=i.enum(["debug","info","notice","warning","error","critical","alert","emergency"]),Ls=I.extend({method:i.literal("logging/setLevel"),params:L.extend({level:mr})}),Ds=U.extend({method:i.literal("notifications/message"),params:je.extend({level:mr,logger:i.optional(i.string()),data:i.unknown()})}),qs=i.object({name:i.string().optional()}).passthrough(),zs=i.object({hints:i.optional(i.array(qs)),costPriority:i.optional(i.number().min(0).max(1)),speedPriority:i.optional(i.number().min(0).max(1)),intelligencePriority:i.optional(i.number().min(0).max(1))}).passthrough(),Hs=i.object({role:i.enum(["user","assistant"]),content:i.union([Qe,et,tt])}).passthrough(),Vs=I.extend({method:i.literal("sampling/createMessage"),params:L.extend({messages:i.array(Hs),systemPrompt:i.optional(i.string()),includeContext:i.optional(i.enum(["none","thisServer","allServers"])),temperature:i.optional(i.number()),maxTokens:i.number().int(),stopSequences:i.optional(i.array(i.string())),metadata:i.optional(i.object({}).passthrough()),modelPreferences:i.optional(zs)})}),wt=D.extend({model:i.string(),stopReason:i.optional(i.enum(["endTurn","stopSequence","maxTokens"]).or(i.string())),role:i.enum(["user","assistant"]),content:i.discriminatedUnion("type",[Qe,et,tt])}),Fs=i.object({type:i.literal("ref/resource"),uri:i.string()}).passthrough(),Us=i.object({type:i.literal("ref/prompt"),name:i.string()}).passthrough(),st=I.extend({method:i.literal("completion/complete"),params:L.extend({ref:i.union([Us,Fs]),argument:i.object({name:i.string(),value:i.string()}).passthrough()})}),Bs=D.extend({completion:i.object({values:i.array(i.string()).max(100),total:i.optional(i.number().int()),hasMore:i.optional(i.boolean())}).passthrough()}),Js=i.object({uri:i.string().startsWith("file://"),name:i.optional(i.string())}).passthrough(),Ws=I.extend({method:i.literal("roots/list")}),St=D.extend({roots:i.array(Js)}),Gs=U.extend({method:i.literal("notifications/roots/list_changed")}),ha=i.union([Fe,xt,st,Ls,Ke,Ye,We,Ge,Xe,Ts,Rs,nt,rt]),ga=i.union([Ve,Ue,kt,Gs]),ya=i.union([He,wt,St]),_a=i.union([Fe,Vs,Ws]),va=i.union([Ve,Ue,Ds,Cs,Ss,$s,Ns]),ba=i.union([He,ys,Bs,js,As,xs,ks,ws,pr,Zs]),T=class extends Error{constructor(e,t,n){super(`MCP error ${e}: ${t}`),this.code=e,this.data=n,this.name="McpError"}};var Xs=6e4,at=class{constructor(e){this._options=e,this._requestMessageId=0,this._requestHandlers=new Map,this._requestHandlerAbortControllers=new Map,this._notificationHandlers=new Map,this._responseHandlers=new Map,this._progressHandlers=new Map,this._timeoutInfo=new Map,this.setNotificationHandler(Ve,t=>{let n=this._requestHandlerAbortControllers.get(t.params.requestId);n?.abort(t.params.reason)}),this.setNotificationHandler(Ue,t=>{this._onprogress(t)}),this.setRequestHandler(Fe,t=>({}))}_setupTimeout(e,t,n,s,a=!1){this._timeoutInfo.set(e,{timeoutId:setTimeout(s,t),startTime:Date.now(),timeout:t,maxTotalTimeout:n,resetTimeoutOnProgress:a,onTimeout:s})}_resetTimeout(e){let t=this._timeoutInfo.get(e);if(!t)return!1;let n=Date.now()-t.startTime;if(t.maxTotalTimeout&&n>=t.maxTotalTimeout)throw this._timeoutInfo.delete(e),new T(S.RequestTimeout,"Maximum total timeout exceeded",{maxTotalTimeout:t.maxTotalTimeout,totalElapsed:n});return clearTimeout(t.timeoutId),t.timeoutId=setTimeout(t.onTimeout,t.timeout),!0}_cleanupTimeout(e){let t=this._timeoutInfo.get(e);t&&(clearTimeout(t.timeoutId),this._timeoutInfo.delete(e))}async connect(e){this._transport=e,this._transport.onclose=()=>{this._onclose()},this._transport.onerror=t=>{this._onerror(t)},this._transport.onmessage=(t,n)=>{bt(t)||ar(t)?this._onresponse(t):er(t)?this._onrequest(t,n):rr(t)?this._onnotification(t):this._onerror(new Error(`Unknown message type: ${JSON.stringify(t)}`))},await this._transport.start()}_onclose(){var e;let t=this._responseHandlers;this._responseHandlers=new Map,this._progressHandlers.clear(),this._transport=void 0,(e=this.onclose)===null||e===void 0||e.call(this);let n=new T(S.ConnectionClosed,"Connection closed");for(let s of t.values())s(n)}_onerror(e){var t;(t=this.onerror)===null||t===void 0||t.call(this,e)}_onnotification(e){var t;let n=(t=this._notificationHandlers.get(e.method))!==null&&t!==void 0?t:this.fallbackNotificationHandler;n!==void 0&&Promise.resolve().then(()=>n(e)).catch(s=>this._onerror(new Error(`Uncaught error in notification handler: ${s}`)))}_onrequest(e,t){var n,s,a,o;let c=(n=this._requestHandlers.get(e.method))!==null&&n!==void 0?n:this.fallbackRequestHandler;if(c===void 0){(s=this._transport)===null||s===void 0||s.send({jsonrpc:"2.0",id:e.id,error:{code:S.MethodNotFound,message:"Method not found"}}).catch(m=>this._onerror(new Error(`Failed to send an error response: ${m}`)));return}let l=new AbortController;this._requestHandlerAbortControllers.set(e.id,l);let u={signal:l.signal,sessionId:(a=this._transport)===null||a===void 0?void 0:a.sessionId,_meta:(o=e.params)===null||o===void 0?void 0:o._meta,sendNotification:m=>this.notification(m,{relatedRequestId:e.id}),sendRequest:(m,w,E)=>this.request(m,w,{...E,relatedRequestId:e.id}),authInfo:t?.authInfo,requestId:e.id};Promise.resolve().then(()=>c(e,u)).then(m=>{var w;if(!l.signal.aborted)return(w=this._transport)===null||w===void 0?void 0:w.send({result:m,jsonrpc:"2.0",id:e.id})},m=>{var w,E;if(!l.signal.aborted)return(w=this._transport)===null||w===void 0?void 0:w.send({jsonrpc:"2.0",id:e.id,error:{code:Number.isSafeInteger(m.code)?m.code:S.InternalError,message:(E=m.message)!==null&&E!==void 0?E:"Internal error"}})}).catch(m=>this._onerror(new Error(`Failed to send response: ${m}`))).finally(()=>{this._requestHandlerAbortControllers.delete(e.id)})}_onprogress(e){let{progressToken:t,...n}=e.params,s=Number(t),a=this._progressHandlers.get(s);if(!a){this._onerror(new Error(`Received a progress notification for an unknown token: ${JSON.stringify(e)}`));return}let o=this._responseHandlers.get(s),c=this._timeoutInfo.get(s);if(c&&o&&c.resetTimeoutOnProgress)try{this._resetTimeout(s)}catch(l){o(l);return}a(n)}_onresponse(e){let t=Number(e.id),n=this._responseHandlers.get(t);if(n===void 0){this._onerror(new Error(`Received a response for an unknown message ID: ${JSON.stringify(e)}`));return}if(this._responseHandlers.delete(t),this._progressHandlers.delete(t),this._cleanupTimeout(t),bt(e))n(e);else{let s=new T(e.error.code,e.error.message,e.error.data);n(s)}}get transport(){return this._transport}async close(){var e;await((e=this._transport)===null||e===void 0?void 0:e.close())}request(e,t,n){let{relatedRequestId:s,resumptionToken:a,onresumptiontoken:o}=n??{};return new Promise((c,l)=>{var u,m,w,E,Q;if(!this._transport){l(new Error("Not connected"));return}((u=this._options)===null||u===void 0?void 0:u.enforceStrictCapabilities)===!0&&this.assertCapabilityForMethod(e.method),(m=n?.signal)===null||m===void 0||m.throwIfAborted();let H=this._requestMessageId++,jt={...e,jsonrpc:"2.0",id:H};n?.onprogress&&(this._progressHandlers.set(H,n.onprogress),jt.params={...e.params,_meta:{progressToken:H}});let Nt=M=>{var ee;this._responseHandlers.delete(H),this._progressHandlers.delete(H),this._cleanupTimeout(H),(ee=this._transport)===null||ee===void 0||ee.send({jsonrpc:"2.0",method:"notifications/cancelled",params:{requestId:H,reason:String(M)}},{relatedRequestId:s,resumptionToken:a,onresumptiontoken:o}).catch(Re=>this._onerror(new Error(`Failed to send cancellation: ${Re}`))),l(M)};this._responseHandlers.set(H,M=>{var ee;if(!(!((ee=n?.signal)===null||ee===void 0)&&ee.aborted)){if(M instanceof Error)return l(M);try{let Re=t.parse(M.result);c(Re)}catch(Re){l(Re)}}}),(w=n?.signal)===null||w===void 0||w.addEventListener("abort",()=>{var M;Nt((M=n?.signal)===null||M===void 0?void 0:M.reason)});let It=(E=n?.timeout)!==null&&E!==void 0?E:Xs,Kr=()=>Nt(new T(S.RequestTimeout,"Request timed out",{timeout:It}));this._setupTimeout(H,It,n?.maxTotalTimeout,Kr,(Q=n?.resetTimeoutOnProgress)!==null&&Q!==void 0?Q:!1),this._transport.send(jt,{relatedRequestId:s,resumptionToken:a,onresumptiontoken:o}).catch(M=>{this._cleanupTimeout(H),l(M)})})}async notification(e,t){if(!this._transport)throw new Error("Not connected");this.assertNotificationCapability(e.method);let n={...e,jsonrpc:"2.0"};await this._transport.send(n,t)}setRequestHandler(e,t){let n=e.shape.method.value;this.assertRequestHandlerCapability(n),this._requestHandlers.set(n,(s,a)=>Promise.resolve(t(e.parse(s),a)))}removeRequestHandler(e){this._requestHandlers.delete(e)}assertCanSetRequestHandler(e){if(this._requestHandlers.has(e))throw new Error(`A request handler for ${e} already exists, which would be overridden`)}setNotificationHandler(e,t){this._notificationHandlers.set(e.shape.method.value,n=>Promise.resolve(t(e.parse(n))))}removeNotificationHandler(e){this._notificationHandlers.delete(e)}};function fr(r,e){return Object.entries(e).reduce((t,[n,s])=>(s&&typeof s=="object"?t[n]=t[n]?{...t[n],...s}:s:t[n]=s,t),{...r})}var it=class extends at{constructor(e,t){var n;super(t),this._serverInfo=e,this._capabilities=(n=t?.capabilities)!==null&&n!==void 0?n:{},this._instructions=t?.instructions,this.setRequestHandler(xt,s=>this._oninitialize(s)),this.setNotificationHandler(kt,()=>{var s;return(s=this.oninitialized)===null||s===void 0?void 0:s.call(this)})}registerCapabilities(e){if(this.transport)throw new Error("Cannot register capabilities after connecting to transport");this._capabilities=fr(this._capabilities,e)}assertCapabilityForMethod(e){var t,n;switch(e){case"sampling/createMessage":if(!(!((t=this._clientCapabilities)===null||t===void 0)&&t.sampling))throw new Error(`Client does not support sampling (required for ${e})`);break;case"roots/list":if(!(!((n=this._clientCapabilities)===null||n===void 0)&&n.roots))throw new Error(`Client does not support listing roots (required for ${e})`);break;case"ping":break}}assertNotificationCapability(e){switch(e){case"notifications/message":if(!this._capabilities.logging)throw new Error(`Server does not support logging (required for ${e})`);break;case"notifications/resources/updated":case"notifications/resources/list_changed":if(!this._capabilities.resources)throw new Error(`Server does not support notifying about resources (required for ${e})`);break;case"notifications/tools/list_changed":if(!this._capabilities.tools)throw new Error(`Server does not support notifying of tool list changes (required for ${e})`);break;case"notifications/prompts/list_changed":if(!this._capabilities.prompts)throw new Error(`Server does not support notifying of prompt list changes (required for ${e})`);break;case"notifications/cancelled":break;case"notifications/progress":break}}assertRequestHandlerCapability(e){switch(e){case"sampling/createMessage":if(!this._capabilities.sampling)throw new Error(`Server does not support sampling (required for ${e})`);break;case"logging/setLevel":if(!this._capabilities.logging)throw new Error(`Server does not support logging (required for ${e})`);break;case"prompts/get":case"prompts/list":if(!this._capabilities.prompts)throw new Error(`Server does not support prompts (required for ${e})`);break;case"resources/list":case"resources/templates/list":case"resources/read":if(!this._capabilities.resources)throw new Error(`Server does not support resources (required for ${e})`);break;case"tools/call":case"tools/list":if(!this._capabilities.tools)throw new Error(`Server does not support tools (required for ${e})`);break;case"ping":case"initialize":break}}async _oninitialize(e){let t=e.params.protocolVersion;return this._clientCapabilities=e.params.capabilities,this._clientVersion=e.params.clientInfo,{protocolVersion:Xt.includes(t)?t:vt,capabilities:this.getCapabilities(),serverInfo:this._serverInfo,...this._instructions&&{instructions:this._instructions}}}getClientCapabilities(){return this._clientCapabilities}getClientVersion(){return this._clientVersion}getCapabilities(){return this._capabilities}async ping(){return this.request({method:"ping"},He)}async createMessage(e,t){return this.request({method:"sampling/createMessage",params:e},wt,t)}async listRoots(e,t){return this.request({method:"roots/list",params:e},St,t)}async sendLoggingMessage(e){return this.notification({method:"notifications/message",params:e})}async sendResourceUpdated(e){return this.notification({method:"notifications/resources/updated",params:e})}async sendResourceListChanged(){return this.notification({method:"notifications/resources/list_changed"})}async sendToolListChanged(){return this.notification({method:"notifications/tools/list_changed"})}async sendPromptListChanged(){return this.notification({method:"notifications/prompts/list_changed"})}};var gr=Symbol("Let zodToJsonSchema decide on which parser to use");var hr={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},yr=r=>typeof r=="string"?{...hr,name:r}:{...hr,...r};var _r=r=>{let e=yr(r),t=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,currentPath:t,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map(([n,s])=>[s._def,{def:s._def,path:[...e.basePath,e.definitionPath,n],jsonSchema:void 0}]))}};function Tt(r,e,t,n){n?.errorMessages&&t&&(r.errorMessage={...r.errorMessage,[e]:t})}function x(r,e,t,n,s){r[e]=t,Tt(r,e,n,s)}function vr(){return{}}function br(r,e){let t={type:"array"};return r.type?._def&&r.type?._def?.typeName!==p.ZodAny&&(t.items=y(r.type._def,{...e,currentPath:[...e.currentPath,"items"]})),r.minLength&&x(t,"minItems",r.minLength.value,r.minLength.message,e),r.maxLength&&x(t,"maxItems",r.maxLength.value,r.maxLength.message,e),r.exactLength&&(x(t,"minItems",r.exactLength.value,r.exactLength.message,e),x(t,"maxItems",r.exactLength.value,r.exactLength.message,e)),t}function xr(r,e){let t={type:"integer",format:"int64"};if(!r.checks)return t;for(let n of r.checks)switch(n.kind){case"min":e.target==="jsonSchema7"?n.inclusive?x(t,"minimum",n.value,n.message,e):x(t,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(t.exclusiveMinimum=!0),x(t,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?x(t,"maximum",n.value,n.message,e):x(t,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(t.exclusiveMaximum=!0),x(t,"maximum",n.value,n.message,e));break;case"multipleOf":x(t,"multipleOf",n.value,n.message,e);break}return t}function kr(){return{type:"boolean"}}function ot(r,e){return y(r.type._def,e)}var wr=(r,e)=>y(r.innerType._def,e);function Rt(r,e,t){let n=t??e.dateStrategy;if(Array.isArray(n))return{anyOf:n.map((s,a)=>Rt(r,e,s))};switch(n){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return Ys(r,e)}}var Ys=(r,e)=>{let t={type:"integer",format:"unix-time"};if(e.target==="openApi3")return t;for(let n of r.checks)switch(n.kind){case"min":x(t,"minimum",n.value,n.message,e);break;case"max":x(t,"maximum",n.value,n.message,e);break}return t};function Sr(r,e){return{...y(r.innerType._def,e),default:r.defaultValue()}}function Tr(r,e){return e.effectStrategy==="input"?y(r.schema._def,e):{}}function Rr(r){return{type:"string",enum:Array.from(r.values)}}var Ks=r=>"type"in r&&r.type==="string"?!1:"allOf"in r;function Cr(r,e){let t=[y(r.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),y(r.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(a=>!!a),n=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0,s=[];return t.forEach(a=>{if(Ks(a))s.push(...a.allOf),a.unevaluatedProperties===void 0&&(n=void 0);else{let o=a;if("additionalProperties"in a&&a.additionalProperties===!1){let{additionalProperties:c,...l}=a;o=l}else n=void 0;s.push(o)}}),s.length?{allOf:s,...n}:void 0}function Pr(r,e){let t=typeof r.value;return t!=="bigint"&&t!=="number"&&t!=="boolean"&&t!=="string"?{type:Array.isArray(r.value)?"array":"object"}:e.target==="openApi3"?{type:t==="bigint"?"integer":t,enum:[r.value]}:{type:t==="bigint"?"integer":t,const:r.value}}var Ct,q={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(Ct===void 0&&(Ct=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),Ct),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function ct(r,e){let t={type:"string"};if(r.checks)for(let n of r.checks)switch(n.kind){case"min":x(t,"minLength",typeof t.minLength=="number"?Math.max(t.minLength,n.value):n.value,n.message,e);break;case"max":x(t,"maxLength",typeof t.maxLength=="number"?Math.min(t.maxLength,n.value):n.value,n.message,e);break;case"email":switch(e.emailStrategy){case"format:email":z(t,"email",n.message,e);break;case"format:idn-email":z(t,"idn-email",n.message,e);break;case"pattern:zod":P(t,q.email,n.message,e);break}break;case"url":z(t,"uri",n.message,e);break;case"uuid":z(t,"uuid",n.message,e);break;case"regex":P(t,n.regex,n.message,e);break;case"cuid":P(t,q.cuid,n.message,e);break;case"cuid2":P(t,q.cuid2,n.message,e);break;case"startsWith":P(t,RegExp(`^${Pt(n.value,e)}`),n.message,e);break;case"endsWith":P(t,RegExp(`${Pt(n.value,e)}$`),n.message,e);break;case"datetime":z(t,"date-time",n.message,e);break;case"date":z(t,"date",n.message,e);break;case"time":z(t,"time",n.message,e);break;case"duration":z(t,"duration",n.message,e);break;case"length":x(t,"minLength",typeof t.minLength=="number"?Math.max(t.minLength,n.value):n.value,n.message,e),x(t,"maxLength",typeof t.maxLength=="number"?Math.min(t.maxLength,n.value):n.value,n.message,e);break;case"includes":{P(t,RegExp(Pt(n.value,e)),n.message,e);break}case"ip":{n.version!=="v6"&&z(t,"ipv4",n.message,e),n.version!=="v4"&&z(t,"ipv6",n.message,e);break}case"base64url":P(t,q.base64url,n.message,e);break;case"jwt":P(t,q.jwt,n.message,e);break;case"cidr":{n.version!=="v6"&&P(t,q.ipv4Cidr,n.message,e),n.version!=="v4"&&P(t,q.ipv6Cidr,n.message,e);break}case"emoji":P(t,q.emoji(),n.message,e);break;case"ulid":{P(t,q.ulid,n.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{z(t,"binary",n.message,e);break}case"contentEncoding:base64":{x(t,"contentEncoding","base64",n.message,e);break}case"pattern:zod":{P(t,q.base64,n.message,e);break}}break}case"nanoid":P(t,q.nanoid,n.message,e);case"toLowerCase":case"toUpperCase":case"trim":break;default:}return t}function Pt(r,e){return e.patternStrategy==="escape"?ea(r):r}var Qs=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function ea(r){let e="";for(let t=0;t<r.length;t++)Qs.has(r[t])||(e+="\\"),e+=r[t];return e}function z(r,e,t,n){r.format||r.anyOf?.some(s=>s.format)?(r.anyOf||(r.anyOf=[]),r.format&&(r.anyOf.push({format:r.format,...r.errorMessage&&n.errorMessages&&{errorMessage:{format:r.errorMessage.format}}}),delete r.format,r.errorMessage&&(delete r.errorMessage.format,Object.keys(r.errorMessage).length===0&&delete r.errorMessage)),r.anyOf.push({format:e,...t&&n.errorMessages&&{errorMessage:{format:t}}})):x(r,"format",e,t,n)}function P(r,e,t,n){r.pattern||r.allOf?.some(s=>s.pattern)?(r.allOf||(r.allOf=[]),r.pattern&&(r.allOf.push({pattern:r.pattern,...r.errorMessage&&n.errorMessages&&{errorMessage:{pattern:r.errorMessage.pattern}}}),delete r.pattern,r.errorMessage&&(delete r.errorMessage.pattern,Object.keys(r.errorMessage).length===0&&delete r.errorMessage)),r.allOf.push({pattern:Er(e,n),...t&&n.errorMessages&&{errorMessage:{pattern:t}}})):x(r,"pattern",Er(e,n),t,n)}function Er(r,e){if(!e.applyRegexFlags||!r.flags)return r.source;let t={i:r.flags.includes("i"),m:r.flags.includes("m"),s:r.flags.includes("s")},n=t.i?r.source.toLowerCase():r.source,s="",a=!1,o=!1,c=!1;for(let l=0;l<n.length;l++){if(a){s+=n[l],a=!1;continue}if(t.i){if(o){if(n[l].match(/[a-z]/)){c?(s+=n[l],s+=`${n[l-2]}-${n[l]}`.toUpperCase(),c=!1):n[l+1]==="-"&&n[l+2]?.match(/[a-z]/)?(s+=n[l],c=!0):s+=`${n[l]}${n[l].toUpperCase()}`;continue}}else if(n[l].match(/[a-z]/)){s+=`[${n[l]}${n[l].toUpperCase()}]`;continue}}if(t.m){if(n[l]==="^"){s+=`(^|(?<=[\r
]))`;continue}else if(n[l]==="$"){s+=`($|(?=[\r
]))`;continue}}if(t.s&&n[l]==="."){s+=o?`${n[l]}\r
`:`[${n[l]}\r
]`;continue}s+=n[l],n[l]==="\\"?a=!0:o&&n[l]==="]"?o=!1:!o&&n[l]==="["&&(o=!0)}try{new RegExp(s)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),r.source}return s}function lt(r,e){if(e.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),e.target==="openApi3"&&r.keyType?._def.typeName===p.ZodEnum)return{type:"object",required:r.keyType._def.values,properties:r.keyType._def.values.reduce((n,s)=>({...n,[s]:y(r.valueType._def,{...e,currentPath:[...e.currentPath,"properties",s]})??{}}),{}),additionalProperties:e.rejectedAdditionalProperties};let t={type:"object",additionalProperties:y(r.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??e.allowedAdditionalProperties};if(e.target==="openApi3")return t;if(r.keyType?._def.typeName===p.ZodString&&r.keyType._def.checks?.length){let{type:n,...s}=ct(r.keyType._def,e);return{...t,propertyNames:s}}else{if(r.keyType?._def.typeName===p.ZodEnum)return{...t,propertyNames:{enum:r.keyType._def.values}};if(r.keyType?._def.typeName===p.ZodBranded&&r.keyType._def.type._def.typeName===p.ZodString&&r.keyType._def.type._def.checks?.length){let{type:n,...s}=ot(r.keyType._def,e);return{...t,propertyNames:s}}}return t}function Ar(r,e){if(e.mapStrategy==="record")return lt(r,e);let t=y(r.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||{},n=y(r.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[t,n],minItems:2,maxItems:2}}}function Or(r){let e=r.values,n=Object.keys(r.values).filter(a=>typeof e[e[a]]!="number").map(a=>e[a]),s=Array.from(new Set(n.map(a=>typeof a)));return{type:s.length===1?s[0]==="string"?"string":"number":["string","number"],enum:n}}function jr(){return{not:{}}}function Nr(r){return r.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}var Ne={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function Mr(r,e){if(e.target==="openApi3")return Ir(r,e);let t=r.options instanceof Map?Array.from(r.options.values()):r.options;if(t.every(n=>n._def.typeName in Ne&&(!n._def.checks||!n._def.checks.length))){let n=t.reduce((s,a)=>{let o=Ne[a._def.typeName];return o&&!s.includes(o)?[...s,o]:s},[]);return{type:n.length>1?n:n[0]}}else if(t.every(n=>n._def.typeName==="ZodLiteral"&&!n.description)){let n=t.reduce((s,a)=>{let o=typeof a._def.value;switch(o){case"string":case"number":case"boolean":return[...s,o];case"bigint":return[...s,"integer"];case"object":if(a._def.value===null)return[...s,"null"];case"symbol":case"undefined":case"function":default:return s}},[]);if(n.length===t.length){let s=n.filter((a,o,c)=>c.indexOf(a)===o);return{type:s.length>1?s:s[0],enum:t.reduce((a,o)=>a.includes(o._def.value)?a:[...a,o._def.value],[])}}}else if(t.every(n=>n._def.typeName==="ZodEnum"))return{type:"string",enum:t.reduce((n,s)=>[...n,...s._def.values.filter(a=>!n.includes(a))],[])};return Ir(r,e)}var Ir=(r,e)=>{let t=(r.options instanceof Map?Array.from(r.options.values()):r.options).map((n,s)=>y(n._def,{...e,currentPath:[...e.currentPath,"anyOf",`${s}`]})).filter(n=>!!n&&(!e.strictUnions||typeof n=="object"&&Object.keys(n).length>0));return t.length?{anyOf:t}:void 0};function Zr(r,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(r.innerType._def.typeName)&&(!r.innerType._def.checks||!r.innerType._def.checks.length))return e.target==="openApi3"?{type:Ne[r.innerType._def.typeName],nullable:!0}:{type:[Ne[r.innerType._def.typeName],"null"]};if(e.target==="openApi3"){let n=y(r.innerType._def,{...e,currentPath:[...e.currentPath]});return n&&"$ref"in n?{allOf:[n],nullable:!0}:n&&{...n,nullable:!0}}let t=y(r.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return t&&{anyOf:[t,{type:"null"}]}}function $r(r,e){let t={type:"number"};if(!r.checks)return t;for(let n of r.checks)switch(n.kind){case"int":t.type="integer",Tt(t,"type",n.message,e);break;case"min":e.target==="jsonSchema7"?n.inclusive?x(t,"minimum",n.value,n.message,e):x(t,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(t.exclusiveMinimum=!0),x(t,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?x(t,"maximum",n.value,n.message,e):x(t,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(t.exclusiveMaximum=!0),x(t,"maximum",n.value,n.message,e));break;case"multipleOf":x(t,"multipleOf",n.value,n.message,e);break}return t}function Lr(r,e){let t=e.target==="openAi",n={type:"object",properties:{}},s=[],a=r.shape();for(let c in a){let l=a[c];if(l===void 0||l._def===void 0)continue;let u=ra(l);u&&t&&(l instanceof A&&(l=l._def.innerType),l.isNullable()||(l=l.nullable()),u=!1);let m=y(l._def,{...e,currentPath:[...e.currentPath,"properties",c],propertyPath:[...e.currentPath,"properties",c]});m!==void 0&&(n.properties[c]=m,u||s.push(c))}s.length&&(n.required=s);let o=ta(r,e);return o!==void 0&&(n.additionalProperties=o),n}function ta(r,e){if(r.catchall._def.typeName!=="ZodNever")return y(r.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]});switch(r.unknownKeys){case"passthrough":return e.allowedAdditionalProperties;case"strict":return e.rejectedAdditionalProperties;case"strip":return e.removeAdditionalStrategy==="strict"?e.allowedAdditionalProperties:e.rejectedAdditionalProperties}}function ra(r){try{return r.isOptional()}catch{return!0}}var Dr=(r,e)=>{if(e.currentPath.toString()===e.propertyPath?.toString())return y(r.innerType._def,e);let t=y(r.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return t?{anyOf:[{not:{}},t]}:{}};var qr=(r,e)=>{if(e.pipeStrategy==="input")return y(r.in._def,e);if(e.pipeStrategy==="output")return y(r.out._def,e);let t=y(r.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),n=y(r.out._def,{...e,currentPath:[...e.currentPath,"allOf",t?"1":"0"]});return{allOf:[t,n].filter(s=>s!==void 0)}};function zr(r,e){return y(r.type._def,e)}function Hr(r,e){let n={type:"array",uniqueItems:!0,items:y(r.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return r.minSize&&x(n,"minItems",r.minSize.value,r.minSize.message,e),r.maxSize&&x(n,"maxItems",r.maxSize.value,r.maxSize.message,e),n}function Vr(r,e){return r.rest?{type:"array",minItems:r.items.length,items:r.items.map((t,n)=>y(t._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((t,n)=>n===void 0?t:[...t,n],[]),additionalItems:y(r.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:r.items.length,maxItems:r.items.length,items:r.items.map((t,n)=>y(t._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((t,n)=>n===void 0?t:[...t,n],[])}}function Fr(){return{not:{}}}function Ur(){return{}}var Br=(r,e)=>y(r.innerType._def,e);var Jr=(r,e,t)=>{switch(e){case p.ZodString:return ct(r,t);case p.ZodNumber:return $r(r,t);case p.ZodObject:return Lr(r,t);case p.ZodBigInt:return xr(r,t);case p.ZodBoolean:return kr();case p.ZodDate:return Rt(r,t);case p.ZodUndefined:return Fr();case p.ZodNull:return Nr(t);case p.ZodArray:return br(r,t);case p.ZodUnion:case p.ZodDiscriminatedUnion:return Mr(r,t);case p.ZodIntersection:return Cr(r,t);case p.ZodTuple:return Vr(r,t);case p.ZodRecord:return lt(r,t);case p.ZodLiteral:return Pr(r,t);case p.ZodEnum:return Rr(r);case p.ZodNativeEnum:return Or(r);case p.ZodNullable:return Zr(r,t);case p.ZodOptional:return Dr(r,t);case p.ZodMap:return Ar(r,t);case p.ZodSet:return Hr(r,t);case p.ZodLazy:return()=>r.getter()._def;case p.ZodPromise:return zr(r,t);case p.ZodNaN:case p.ZodNever:return jr();case p.ZodEffects:return Tr(r,t);case p.ZodAny:return vr();case p.ZodUnknown:return Ur();case p.ZodDefault:return Sr(r,t);case p.ZodBranded:return ot(r,t);case p.ZodReadonly:return Br(r,t);case p.ZodCatch:return wr(r,t);case p.ZodPipeline:return qr(r,t);case p.ZodFunction:case p.ZodVoid:case p.ZodSymbol:return;default:return(n=>{})(e)}};function y(r,e,t=!1){let n=e.seen.get(r);if(e.override){let c=e.override?.(r,e,n,t);if(c!==gr)return c}if(n&&!t){let c=na(n,e);if(c!==void 0)return c}let s={def:r,path:e.currentPath,jsonSchema:void 0};e.seen.set(r,s);let a=Jr(r,r.typeName,e),o=typeof a=="function"?y(a(),e):a;if(o&&aa(r,e,o),e.postProcess){let c=e.postProcess(o,r,e);return s.jsonSchema=o,c}return s.jsonSchema=o,o}var na=(r,e)=>{switch(e.$refStrategy){case"root":return{$ref:r.path.join("/")};case"relative":return{$ref:sa(e.currentPath,r.path)};case"none":case"seen":return r.path.length<e.currentPath.length&&r.path.every((t,n)=>e.currentPath[n]===t)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),{}):e.$refStrategy==="seen"?{}:void 0}},sa=(r,e)=>{let t=0;for(;t<r.length&&t<e.length&&r[t]===e[t];t++);return[(r.length-t).toString(),...e.slice(t)].join("/")},aa=(r,e,t)=>(r.description&&(t.description=r.description,e.markdownDescription&&(t.markdownDescription=r.description)),t);var Et=(r,e)=>{let t=_r(e),n=typeof e=="object"&&e.definitions?Object.entries(e.definitions).reduce((l,[u,m])=>({...l,[u]:y(m._def,{...t,currentPath:[...t.basePath,t.definitionPath,u]},!0)??{}}),{}):void 0,s=typeof e=="string"?e:e?.nameStrategy==="title"?void 0:e?.name,a=y(r._def,s===void 0?t:{...t,currentPath:[...t.basePath,t.definitionPath,s]},!1)??{},o=typeof e=="object"&&e.name!==void 0&&e.nameStrategy==="title"?e.name:void 0;o!==void 0&&(a.title=o);let c=s===void 0?n?{...a,[t.definitionPath]:n}:a:{$ref:[...t.$refStrategy==="relative"?[]:t.basePath,t.definitionPath,s].join("/"),[t.definitionPath]:{...n,[s]:a}};return t.target==="jsonSchema7"?c.$schema="http://json-schema.org/draft-07/schema#":(t.target==="jsonSchema2019-09"||t.target==="openAi")&&(c.$schema="https://json-schema.org/draft/2019-09/schema#"),t.target==="openAi"&&("anyOf"in c||"oneOf"in c||"allOf"in c||"type"in c&&Array.isArray(c.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),c};var At;(function(r){r.Completable="McpCompletable"})(At||(At={}));var Te=class extends v{_parse(e){let{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}};Te.create=(r,e)=>new Te({type:r,typeName:At.Completable,complete:e.complete,...ia(e)});function ia(r){if(!r)return{};let{errorMap:e,invalid_type_error:t,required_error:n,description:s}=r;if(e&&(t||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(o,c)=>{var l,u;let{message:m}=r;return o.code==="invalid_enum_value"?{message:m??c.defaultError}:typeof c.data>"u"?{message:(l=m??n)!==null&&l!==void 0?l:c.defaultError}:o.code!=="invalid_type"?{message:c.defaultError}:{message:(u=m??t)!==null&&u!==void 0?u:c.defaultError}},description:s}}var dt=class{constructor(e,t){this._registeredResources={},this._registeredResourceTemplates={},this._registeredTools={},this._registeredPrompts={},this._toolHandlersInitialized=!1,this._completionHandlerInitialized=!1,this._resourceHandlersInitialized=!1,this._promptHandlersInitialized=!1,this.server=new it(e,t)}async connect(e){return await this.server.connect(e)}async close(){await this.server.close()}setToolRequestHandlers(){this._toolHandlersInitialized||(this.server.assertCanSetRequestHandler(rt.shape.method.value),this.server.assertCanSetRequestHandler(nt.shape.method.value),this.server.registerCapabilities({tools:{listChanged:!0}}),this.server.setRequestHandler(rt,()=>({tools:Object.entries(this._registeredTools).filter(([,e])=>e.enabled).map(([e,t])=>({name:e,description:t.description,inputSchema:t.inputSchema?Et(t.inputSchema,{strictUnions:!0}):oa,annotations:t.annotations}))})),this.server.setRequestHandler(nt,async(e,t)=>{let n=this._registeredTools[e.params.name];if(!n)throw new T(S.InvalidParams,`Tool ${e.params.name} not found`);if(!n.enabled)throw new T(S.InvalidParams,`Tool ${e.params.name} disabled`);if(n.inputSchema){let s=await n.inputSchema.safeParseAsync(e.params.arguments);if(!s.success)throw new T(S.InvalidParams,`Invalid arguments for tool ${e.params.name}: ${s.error.message}`);let a=s.data,o=n.callback;try{return await Promise.resolve(o(a,t))}catch(c){return{content:[{type:"text",text:c instanceof Error?c.message:String(c)}],isError:!0}}}else{let s=n.callback;try{return await Promise.resolve(s(t))}catch(a){return{content:[{type:"text",text:a instanceof Error?a.message:String(a)}],isError:!0}}}}),this._toolHandlersInitialized=!0)}setCompletionRequestHandler(){this._completionHandlerInitialized||(this.server.assertCanSetRequestHandler(st.shape.method.value),this.server.setRequestHandler(st,async e=>{switch(e.params.ref.type){case"ref/prompt":return this.handlePromptCompletion(e,e.params.ref);case"ref/resource":return this.handleResourceCompletion(e,e.params.ref);default:throw new T(S.InvalidParams,`Invalid completion reference: ${e.params.ref}`)}}),this._completionHandlerInitialized=!0)}async handlePromptCompletion(e,t){let n=this._registeredPrompts[t.name];if(!n)throw new T(S.InvalidParams,`Prompt ${t.name} not found`);if(!n.enabled)throw new T(S.InvalidParams,`Prompt ${t.name} disabled`);if(!n.argsSchema)return ut;let s=n.argsSchema.shape[e.params.argument.name];if(!(s instanceof Te))return ut;let o=await s._def.complete(e.params.argument.value);return Gr(o)}async handleResourceCompletion(e,t){let n=Object.values(this._registeredResourceTemplates).find(o=>o.resourceTemplate.uriTemplate.toString()===t.uri);if(!n){if(this._registeredResources[t.uri])return ut;throw new T(S.InvalidParams,`Resource template ${e.params.ref.uri} not found`)}let s=n.resourceTemplate.completeCallback(e.params.argument.name);if(!s)return ut;let a=await s(e.params.argument.value);return Gr(a)}setResourceRequestHandlers(){this._resourceHandlersInitialized||(this.server.assertCanSetRequestHandler(We.shape.method.value),this.server.assertCanSetRequestHandler(Ge.shape.method.value),this.server.assertCanSetRequestHandler(Xe.shape.method.value),this.server.registerCapabilities({resources:{listChanged:!0}}),this.server.setRequestHandler(We,async(e,t)=>{let n=Object.entries(this._registeredResources).filter(([a,o])=>o.enabled).map(([a,o])=>({uri:a,name:o.name,...o.metadata})),s=[];for(let a of Object.values(this._registeredResourceTemplates)){if(!a.resourceTemplate.listCallback)continue;let o=await a.resourceTemplate.listCallback(t);for(let c of o.resources)s.push({...c,...a.metadata})}return{resources:[...n,...s]}}),this.server.setRequestHandler(Ge,async()=>({resourceTemplates:Object.entries(this._registeredResourceTemplates).map(([t,n])=>({name:t,uriTemplate:n.resourceTemplate.uriTemplate.toString(),...n.metadata}))})),this.server.setRequestHandler(Xe,async(e,t)=>{let n=new URL(e.params.uri),s=this._registeredResources[n.toString()];if(s){if(!s.enabled)throw new T(S.InvalidParams,`Resource ${n} disabled`);return s.readCallback(n,t)}for(let a of Object.values(this._registeredResourceTemplates)){let o=a.resourceTemplate.uriTemplate.match(n.toString());if(o)return a.readCallback(n,o,t)}throw new T(S.InvalidParams,`Resource ${n} not found`)}),this.setCompletionRequestHandler(),this._resourceHandlersInitialized=!0)}setPromptRequestHandlers(){this._promptHandlersInitialized||(this.server.assertCanSetRequestHandler(Ye.shape.method.value),this.server.assertCanSetRequestHandler(Ke.shape.method.value),this.server.registerCapabilities({prompts:{listChanged:!0}}),this.server.setRequestHandler(Ye,()=>({prompts:Object.entries(this._registeredPrompts).filter(([,e])=>e.enabled).map(([e,t])=>({name:e,description:t.description,arguments:t.argsSchema?la(t.argsSchema):void 0}))})),this.server.setRequestHandler(Ke,async(e,t)=>{let n=this._registeredPrompts[e.params.name];if(!n)throw new T(S.InvalidParams,`Prompt ${e.params.name} not found`);if(!n.enabled)throw new T(S.InvalidParams,`Prompt ${e.params.name} disabled`);if(n.argsSchema){let s=await n.argsSchema.safeParseAsync(e.params.arguments);if(!s.success)throw new T(S.InvalidParams,`Invalid arguments for prompt ${e.params.name}: ${s.error.message}`);let a=s.data,o=n.callback;return await Promise.resolve(o(a,t))}else{let s=n.callback;return await Promise.resolve(s(t))}}),this.setCompletionRequestHandler(),this._promptHandlersInitialized=!0)}resource(e,t,...n){let s;typeof n[0]=="object"&&(s=n.shift());let a=n[0];if(typeof t=="string"){if(this._registeredResources[t])throw new Error(`Resource ${t} is already registered`);let o={name:e,metadata:s,readCallback:a,enabled:!0,disable:()=>o.update({enabled:!1}),enable:()=>o.update({enabled:!0}),remove:()=>o.update({uri:null}),update:c=>{typeof c.uri<"u"&&c.uri!==t&&(delete this._registeredResources[t],c.uri&&(this._registeredResources[c.uri]=o)),typeof c.name<"u"&&(o.name=c.name),typeof c.metadata<"u"&&(o.metadata=c.metadata),typeof c.callback<"u"&&(o.readCallback=c.callback),typeof c.enabled<"u"&&(o.enabled=c.enabled),this.sendResourceListChanged()}};return this._registeredResources[t]=o,this.setResourceRequestHandlers(),this.sendResourceListChanged(),o}else{if(this._registeredResourceTemplates[e])throw new Error(`Resource template ${e} is already registered`);let o={resourceTemplate:t,metadata:s,readCallback:a,enabled:!0,disable:()=>o.update({enabled:!1}),enable:()=>o.update({enabled:!0}),remove:()=>o.update({name:null}),update:c=>{typeof c.name<"u"&&c.name!==e&&(delete this._registeredResourceTemplates[e],c.name&&(this._registeredResourceTemplates[c.name]=o)),typeof c.template<"u"&&(o.resourceTemplate=c.template),typeof c.metadata<"u"&&(o.metadata=c.metadata),typeof c.callback<"u"&&(o.readCallback=c.callback),typeof c.enabled<"u"&&(o.enabled=c.enabled),this.sendResourceListChanged()}};return this._registeredResourceTemplates[e]=o,this.setResourceRequestHandlers(),this.sendResourceListChanged(),o}}tool(e,...t){if(this._registeredTools[e])throw new Error(`Tool ${e} is already registered`);let n;typeof t[0]=="string"&&(n=t.shift());let s,a;if(t.length>1){let l=t[0];Wr(l)?(s=t.shift(),t.length>1&&typeof t[0]=="object"&&t[0]!==null&&!Wr(t[0])&&(a=t.shift())):typeof l=="object"&&l!==null&&(a=t.shift())}let o=t[0],c={description:n,inputSchema:s===void 0?void 0:i.object(s),annotations:a,callback:o,enabled:!0,disable:()=>c.update({enabled:!1}),enable:()=>c.update({enabled:!0}),remove:()=>c.update({name:null}),update:l=>{typeof l.name<"u"&&l.name!==e&&(delete this._registeredTools[e],l.name&&(this._registeredTools[l.name]=c)),typeof l.description<"u"&&(c.description=l.description),typeof l.paramsSchema<"u"&&(c.inputSchema=i.object(l.paramsSchema)),typeof l.callback<"u"&&(c.callback=l.callback),typeof l.annotations<"u"&&(c.annotations=l.annotations),typeof l.enabled<"u"&&(c.enabled=l.enabled),this.sendToolListChanged()}};return this._registeredTools[e]=c,this.setToolRequestHandlers(),this.sendToolListChanged(),c}prompt(e,...t){if(this._registeredPrompts[e])throw new Error(`Prompt ${e} is already registered`);let n;typeof t[0]=="string"&&(n=t.shift());let s;t.length>1&&(s=t.shift());let a=t[0],o={description:n,argsSchema:s===void 0?void 0:i.object(s),callback:a,enabled:!0,disable:()=>o.update({enabled:!1}),enable:()=>o.update({enabled:!0}),remove:()=>o.update({name:null}),update:c=>{typeof c.name<"u"&&c.name!==e&&(delete this._registeredPrompts[e],c.name&&(this._registeredPrompts[c.name]=o)),typeof c.description<"u"&&(o.description=c.description),typeof c.argsSchema<"u"&&(o.argsSchema=i.object(c.argsSchema)),typeof c.callback<"u"&&(o.callback=c.callback),typeof c.enabled<"u"&&(o.enabled=c.enabled),this.sendPromptListChanged()}};return this._registeredPrompts[e]=o,this.setPromptRequestHandlers(),this.sendPromptListChanged(),o}isConnected(){return this.server.transport!==void 0}sendResourceListChanged(){this.isConnected()&&this.server.sendResourceListChanged()}sendToolListChanged(){this.isConnected()&&this.server.sendToolListChanged()}sendPromptListChanged(){this.isConnected()&&this.server.sendPromptListChanged()}};var oa={type:"object"};function Wr(r){return typeof r!="object"||r===null?!1:Object.keys(r).length===0||Object.values(r).some(ca)}function ca(r){return r!==null&&typeof r=="object"&&"parse"in r&&typeof r.parse=="function"&&"safeParse"in r&&typeof r.safeParse=="function"}function la(r){return Object.entries(r.shape).map(([e,t])=>({name:e,description:t.description,required:!t.isOptional()}))}function Gr(r){return{completion:{values:r.slice(0,100),total:r.length,hasMore:r.length>100}}}var ut={completion:{values:[],hasMore:!1}};var Ot=Zt(require("node:process"),1);var pt=class{append(e){this._buffer=this._buffer?Buffer.concat([this._buffer,e]):e}readMessage(){if(!this._buffer)return null;let e=this._buffer.indexOf(`
`);if(e===-1)return null;let t=this._buffer.toString("utf8",0,e).replace(/\r$/,"");return this._buffer=this._buffer.subarray(e+1),ua(t)}clear(){this._buffer=void 0}};function ua(r){return ir.parse(JSON.parse(r))}function Xr(r){return JSON.stringify(r)+`
`}var mt=class{constructor(e=Ot.default.stdin,t=Ot.default.stdout){this._stdin=e,this._stdout=t,this._readBuffer=new pt,this._started=!1,this._ondata=n=>{this._readBuffer.append(n),this.processReadBuffer()},this._onerror=n=>{var s;(s=this.onerror)===null||s===void 0||s.call(this,n)}}async start(){if(this._started)throw new Error("StdioServerTransport already started! If using Server class, note that connect() calls start() automatically.");this._started=!0,this._stdin.on("data",this._ondata),this._stdin.on("error",this._onerror)}processReadBuffer(){for(var e,t;;)try{let n=this._readBuffer.readMessage();if(n===null)break;(e=this.onmessage)===null||e===void 0||e.call(this,n)}catch(n){(t=this.onerror)===null||t===void 0||t.call(this,n)}}async close(){var e;this._stdin.off("data",this._ondata),this._stdin.off("error",this._onerror),this._stdin.listenerCount("data")===0&&this._stdin.pause(),this._readBuffer.clear(),(e=this.onclose)===null||e===void 0||e.call(this)}send(e){return new Promise(t=>{let n=Xr(e);this._stdout.write(n)?t():this._stdout.once("drain",t)})}};(async()=>{try{let r=await fetch("http://172.24.128.1:3000/keus/v1/node_configuration/GetNodeConfig");if(!r.ok)throw new Error(`Failed to fetch node configuration: ${r.statusText}`);let t=(await r.json()).nodeConfig.siteInfo.siteId,n=new Yr.default.ServiceBroker({namespace:t,nodeID:crypto.randomUUID(),transporter:{type:"NATS",options:{url:"nats://172.24.128.1:9769",token:"keus-iot-platform"}},logger:{type:"Console",options:{level:"info"}}});await n.start();let s=new dt({name:"example-server",version:"1.0.0"},{capabilities:{tools:{},resources:{}}});s.tool("GetAllService","Get the details of all services available on keus-iot-platform",{query:i.string()},async c=>{try{let l=await n.call("$node.services");return{content:[{type:"text",text:JSON.stringify(l,null,2)}]}}catch(l){return console.error("Error fetching services:",l),{content:[{type:"text",text:`Error fetching services: ${l instanceof Error?l.message:"Unknown error occurred"}`}],isError:!0}}}),s.tool("GetAllActions","Get the details of all actions available on keus-iot-platform",{query:i.string()},async c=>{try{let l=await n.call("$node.actions");return{content:[{type:"text",text:JSON.stringify(l,null,2)}]}}catch(l){return console.error("Error fetching actions:",l),{content:[{type:"text",text:`Error fetching actions: ${l instanceof Error?l.message:"Unknown error occurred"}`}],isError:!0}}});let a=new mt;await s.connect(a),console.log("MCP server connected successfully");let o=async()=>{console.log("Shutting down servers..."),await n.stop(),await s.close(),console.log("Servers stopped successfully"),process.exit(0)};process.on("SIGINT",o),process.on("SIGTERM",o)}catch(r){console.error("Fatal error:",r),process.exit(1)}})();
//# sourceMappingURL=out.js.map
